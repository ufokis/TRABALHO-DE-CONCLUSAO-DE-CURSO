%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\chapter{Propagação de ondas eletromagnéticas em meio linear}\label{cap:capitulo3}

Neste Capítulo, revisitamos conceitos importantes do eletromagnetismo, que permitirá estudarmos a propagação de pulsos eletromagnéticos através de um ensemble de sistemas de 2 níveis. Para isso, primeiramente apresentaremos a propagação num meio linear usando aproximação de envoltória lenta e depois expandiremos para o caso de um meio atômico, onde efeitos não lineares estão presentes.


\section{Equações de Maxwell}
\label{secao3.1}
Em princípio, sabemos que as leis do electromagnetismo para um meio podem ser resumidas nas quatro equações de Maxwell \cite{jackson1998classical,griffiths2011elet}:
\begin{eqnarray}
\div{\vb{D}} & = & \varrho_l\textrm{~~(Lei de Gauss)},\label{eq:3.1}\\
\curl{\vb{H}} - \pdv{\vb{D}}{t} & = & \vb{J}_l\textrm{~~(Lei de Ampère)},\label{eq:3.2}\\
\curl{\vb{E}} + \pdv{\vb{B}}{t} & = & 0 \textrm{~~(Lei de Faraday)},\label{eq:3.3}\\
\div{\vb{B}} & = & 0\textrm{~~(Lei de Gauss para o magnetismo)}.\label{eq:3.4}
\end{eqnarray}
A lei de Gauss  apresenta a existência de cargas elétricas positiva e negativa, sendo $\varrho_l~\text{(C/m}^\text{3}\text{)}$ a densidade de carga elétrica livre. A lei de Àmpere estabelece que uma densidade de corrente elétrica $\vb{J}_l~\text{(A/m}^\text{2}\text{)}$, ou um deslocamento elétrico $\vb{D}~\text{(C/m}^\text{2}\text{)}$ variável no tempo, produz uma distribuição de campo magnetizante $\vb{H}~\text{(A/m)}$. A lei de Faraday estabelece que a variação no campo magnético $\vb{B}~\text{(Wb/m}^\text{2}\text{)}$ produz uma distribuição de campo elétrico $\vb{E}~\text{(V/m)}$. A lei de Gauss para o magnetismo informa a não existência de cargas magnéticas. O  deslocamento elétrico $\vb{D}$ e o campo magnetizante $\vb{H}$ se relacionam com $\vb{E}$ and $\vb{B}$ a partir das equações:

\begin{equation}
\vb{D}  =  \epsilon_0\vb{E} + \vb{P}\label{eq:3.5}
\end{equation}
e
\begin{equation}
\vb{B} = \mu_0\vb{H} + \vb{M},\label{eq:3.6}
\end{equation}
sendo $\vb{P}$ a polarização elétrica e $\vb{M}$ magnetização de um meio material. A polarização ocorre quando sujeitamos um dielétrico a um campo elétrico. Isso acarreta uma distorção da distribuição interna de cargas, gerando dipolo elétricos que contribuem com o campo elétrico interno total no meio, ou seja, o campo externo separa as carga positiva e negativa do material, e esta contribui para uma componente adicional para o campo. O momento dipolar por unidade de volume é o que chamamos de polarização elétrica e obedece a seguinte definição:
\begin{equation}
\vb{P} \equiv \frac{1}{V}\sum_i \vb{d_i}.
\label{eq:3.7}
\end{equation}
A magnetização da matéria ocorre quando é aplicado um campo magnético externo. Dois mecanismos atômicos que justificam esse fenômeno são: o paramagnetismo, em que os dipolos referentes aos spins (momento angular intrínseco) de elétrons sem par se alinham ao campo magnético externo, e o diamagnetismo, no qual o campo magnético externo provoca alteração na velocidade orbital, ocasionando uma mudança no momento de dipolo orbital em sentido oposto a campo magnético externo. Podemos definir a magnetização $\vb{M}$ como momento do dipolo magnético resultante por unidade de volume, conforme a equação:
\begin{equation}
\vb{M} \equiv \frac{1}{V}\sum_i \vb{m_i}.
\label{eq:3.8}
\end{equation}
Neste TCC estudamos meio atômico eletricamente neutro e não magnético. Assim, podemos desconsiderar $\varrho_l$ , $\vb{J}_l$ e $\vb{M}$, fazendo
\begin{equation}
\qty|\varrho_l| = \qty|\vb{J}_l| = \qty|\vb{M}| = 0.
\label{eq:3.9}
\end{equation}

Aplicando o operador rotacional à lei de Faraday \eqref{eq:3.3}, obtemos:
\begin{eqnarray}
\curl{(\curl{\vb{E}})} + \curl{\pdv{\vb{B}}{t}} & = & 0\nonumber\\
\grad{(\div{\vb{E}})} - \laplacian{\vb{E}} + \pdv{t}(\curl{\vb{B}}) & = & 0.
\label{eq:3.10}
\end{eqnarray}

Usando as relações \eqref{eq:3.5} e \eqref{eq:3.6} na lei de Ampère \eqref{eq:3.2}, respeitando as condições \eqref{eq:3.9}, obtemos:
\begin{equation}
\curl{\vb{B}} = \mu_0 \pdv{t}(\epsilon_0\vb{E} + \vb{P}).\label{eq:3.11}
\end{equation}

Substituindo esse resultado em \eqref{eq:3.10} e usando o fato de que $\grad(\div\vb{E})=0$, obtemos a seguinte equação de onda para o campo elétrico em um meio material \cite{allen1987optical}:  
\begin{equation}
\laplacian{\vb{E}} - \frac{1}{c^2}\pdv[2]{\vb{E}}{t}= \mu_0 \pdv[2]{t}\vb{P}.\label{eq:3.12}
\end{equation}

Veja que o termo a esquerda da igualdade é equivalente equação da onda para a propagação da luz no vácuo, enquanto que o termo no lado direito representa a interação do campo eletromagnético com o meio material.

A polarização $\vb{P}$ pode ser decomposta em duas partes :
\begin{equation}
\vb{P} = \vb{P^L} + \vb{P^{NL}},
\label{eq:3.13}
\end{equation}
onde $\vb{P^L}$ representa contribuições que variam de forma linear e $\vb{P^{NL}}$ as contribuições que variam de forma não-linear com o campo elétrico aplicado \cite{boyd2008nonlinear, diels2006ultrashort}. 

Na próxima Seção \ref{sec:linear} apresentamos a solução da equação~\eqref{eq:3.12} para um pulso de campo eletromagnético que interage com material linear e, posteriormente, na Seção \ref{sec:naolinear}, apresentamos o caso não linear que se aplica ao sistema atômico de dois níveis, ao qual estudaremos no Capítulo \ref{cap:capitulo4}.

\section{propagação de onda em meio linear}\label{sec:linear}

A equação de propagação da onda \eqref{eq:3.12}, normalmente é resolvida somente usando métodos numéricos. No entanto, podemos realizar simplificações e aproximações que, ainda assim, nos permita  lidar com problemas práticos da propagação de pulsos em um meio material \cite{diels2006ultrashort}. Para um meio linear, podemos reescrever a equação \eqref{eq:3.12} da seguinte forma:
\begin{equation}
\pdv[2]{z}E(z,t) - \frac{1}{c^2}\pdv[2]{t}E(z,t)= \mu_0 \pdv[2]{t}P^L(z,t).
\label{eq:3.14}
\end{equation}
Para simplificar as operações que faremos com o Campo eletromagnético $E$, decompomos o campo em uma parte com frequências positivas e outra com a frequências negativas:
\begin{equation}
	E(z,t) = E^+(z,t) + E^-(z,t)
	\label{posneg}
\end{equation}
onde $E^+(z,t)$ é complexo e  
\begin{equation}
	E^-(z,t)= [E^+(z,t)]^*
\end{equation} 
Sabemos que, em um meio linear, a polarização se relaciona com o campo elétrico a partir da susceptibilidade elétrica $\chi_e$ \cite{jackson1998classical,griffiths2011elet}, seguindo a seguinte covolução: 
\begin{equation}
P^L(z,t) = \epsilon_0\int_{-\infty}^{t}dt'~\chi_e(t-t')E(z,t').
\label{eq:3.15}
\end{equation}
Isso nos diz que um material não pode polarizar instantaneamente em reposta a um campo aplicado, ou seja, a polarização é uma convolução do campo elétrico em tempos anteriores, onde a susceptibilidade é dada por $\chi_e(\Delta t)$. Substituindo \ref{posneg} em \ref{eq:3.15}, podemos decompor a polarização da seguinte forma:
\begin{eqnarray}
	P^L(z,t) &=& \epsilon_0\int_{-\infty}^{t}dt'~\chi_e(t-t')\qty[E^+(z,t')+E^-(z,t')]\\
	&=&\epsilon_0\int_{-\infty}^{t}dt'~\chi_e(t-t')E^+(z,t')+\epsilon_0\int_{-\infty}^{t}dt'~\chi_e(t-t')E^-(z,t')\\&=&P^{L+}(z,t)+P^{L-}(z,t).
	\label{polcov}
\end{eqnarray}
onde $P^{L-}(z,t)=[P^{L+}(z,t)]^*.$
Assim podemos escrever a EDO apenas dos termos com frequência positiva da seguinte forma
\begin{equation}
	\pdv[2]{z}E^+(z,t) - \frac{1}{c^2}\pdv[2]{t}E^+(z,t)= \mu_0 \pdv[2]{t}P^{L+}(z,t).
\end{equation}
onde
 \begin{equation}
	P^{L+}(z,t) = \epsilon_0\int_{-\infty}^{t}dt'~\chi_e(t-t')E^+(z,t').
\end{equation}
Podemos estender o limite superior desta integral ao infinito considerando que
\begin{equation}
\chi_e(\Delta t) = 0 ~\textrm{para}~\Delta t < 0.
\label{eq:3.16}
\end{equation}  
e, assim, reescrevemos \eqref{eq:3.15} no domínio da frequência, fazendo a seguinte transformada de Fourier:
\begin{eqnarray}
\tilde{P}^{L+}(z,\omega) & = & \epsilon_0\int_{-\infty}^{\infty}dt~P^{L+}(z,t) e^{-i\omega t}\nonumber\\& = & \epsilon_0\int_{-\infty}^{\infty}dt\int_{-\infty}^{\infty}dt'\chi_e(t-t')E^+(z,t')e^{-i\omega t}\nonumber\\& = & \epsilon_0\int_{-\infty}^{\infty}dt\int_{-\infty}^{\infty}dt'\chi_e(t)E^+(z,t')e^{-i\omega(t+t')}\nonumber\\& = & \epsilon_0\int_{-\infty}^{\infty}dt'~E^+(z,t')\int_{-\infty}^{\infty}dt~\chi_e(t)e^{-i\omega( t + t' )}\nonumber\\& = & \epsilon_0\int_{-\infty}^{\infty}dt~\chi_e(t)e^{-i\omega t}\int_{-\infty}^{\infty}dt'~E^+(z,t')e^{-i\omega t'}\nonumber\\& = & \epsilon_0\tilde{\chi}_e(\omega)\tilde{E}^+(z,\omega).
\label{eq:3.17}
\end{eqnarray}

Usando a transformada de Fourier inversa de $E(z,t)$ em \eqref{eq:3.14}, obtemos:
\begin{eqnarray}
\qty[\pdv[2]{z} - \frac{1}{c^2}\pdv[2]{t}]E^+(z,t)&=& \mu_0 \pdv[2]{t}P^{L+}(z,t)\nonumber\\\qty[\pdv[2]{z} - \frac{1}{c^2}\pdv[2]{t}]\qty[\frac{1}{2\pi}\int_{-\infty}^\infty d\omega \tilde{E}^+(z,\omega)e^{i\omega t}]&=& \mu_0 \pdv[2]{t}\qty[\frac{1}{2\pi}\int_{-\infty}^\infty d\omega \tilde{P}^{L+}(z,\omega)e^{i\omega t}]\nonumber\\\qty[\pdv[2]{z} + \frac{\omega^2}{c^2}]\tilde{E}^+(z,\omega) &=& -\mu_0 \omega^2\tilde{P}^{L+}(z,\omega).
\label{eq:3.18}
\end{eqnarray}

Substituindo \eqref{eq:3.17} em \eqref{eq:3.18} e usando o fato de que $c^2=\frac{1}{\mu_0\epsilon_0}$ , obtemos: 
\begin{eqnarray}
\qty[\pdv[2]{z} + \mu_0\omega^2\epsilon_0]\tilde{E}^+(z,\omega) &=& -\mu_0 \omega^2\epsilon_0\tilde{\chi}_e(\omega)\tilde{E}^+(z,\omega)\nonumber\\\qty[\pdv[2]{z} + \mu_0\omega^2\epsilon_0\qty(1+\chi_e(\omega))]\tilde{E}^+(z,\omega) &=& 0\nonumber\\
\qty[\pdv[2]{z} + \mu_0\omega^2\epsilon(\omega)]\tilde{E}^+(z,\omega) &=& 0,
\label{eq:3.19}
\end{eqnarray}
onde definimos
\begin{equation}
\epsilon(\omega) = \epsilon_0[1+\chi_e(z,\omega)]
\label{3.20}
\end{equation}
é a permissividade elétrica do material. Para resolvermos a equação \eqref{eq:3.19}, assumimos que a  susceptibilidade elétrica e a permissividade elétrica do material são reais. Assim, a solução da EDO na direção $+z$ é:      
\begin{equation}
\tilde{E}^+(z,\omega) = \tilde{E}^+(0,\omega)e^{-ik(\omega)z},
\label{eq:3.21}
\end{equation}
onde $k(\omega)$ é o vetor de onda, dado a partir da relação de dispersão da óptica linear
\begin{equation}
k^2(\omega) \equiv \omega^2\epsilon(\omega)\mu_0=\frac{\omega^2}{c^2}n(\omega),\label{eq:3.22}
\end{equation}
em que $n(\omega)$ é o índice de refração do material. Para uma análise mais minuciosa, é interessante expandir $k(\omega)$ em série de Taylor, em torno da frequência central $\omega_c$:
\begin{equation}
k(\omega) = k(\omega_c) + \underbrace{\pdv{k}{\omega}\Big|_{\omega_c}(\omega-\omega_c) + \frac{1}{2}\pdv[2]{k}{\omega}\Big|_{\omega_c}(\omega-\omega_c)^2 + \cdots}_{\Delta\kappa}
\label{eq:3.23}
\end{equation}  
Assim, 
\begin{equation}
k(\omega) \equiv k(\omega_c) + \Delta\kappa.
\label{eq:3.24}
\end{equation}  

Substituindo \eqref{eq:3.24} na equação de onda \eqref{eq:3.21}, temos:
\begin{equation}
\tilde{E}^+(z,\omega) = \tilde{E}^+(0,\omega)e^{-ik_cz}e^{-i\Delta\kappa z},
\label{eq:3.25}
\end{equation}
onde 
\begin{equation}
k_c^2 \equiv k^2(\omega_c) = \omega_c^2\epsilon(\omega_c)\mu_0=\frac{\omega_c^2}{c^2}n(\omega_c).\label{eq:3.26}
\end{equation}

Para o caso prático que nos interessa neste TCC, centralizamos a amplitude de Fourier em uma frequência $\omega_c$. Assim, aplicando a transformada de Fourier inversa à equação \eqref{eq:3.25}, obtemos:
\begin{eqnarray}
E^+(z,t) & = & \frac{1}{2\pi}\int_{-\infty}^\infty d\omega \tilde{E}^+(z,\omega)e^{i\omega t}\nonumber\\& = & \frac{1}{2\pi}\int_{-\infty}^\infty d\omega \tilde{E}^+(0,\omega)e^{-ik_cz - i\Delta kz}e^{i\omega t}\nonumber\\& = & \frac{1}{2\pi}\int_{-\infty}^\infty d\omega \tilde{E}^+(0,\omega+\omega_c)e^{-ik_cz - i\Delta kz}e^{i(\omega + \omega_c)t}\nonumber\\& = & \frac{1}{2\pi}\qty[\int_{-\infty}^\infty d\omega \tilde{E}^+(0,\omega + \omega_c)e^{ - i\Delta kz}e^{i\omega t} ]  e^{iw_ct-ik_cz}.
\label{eq:3.30}
\end{eqnarray}
 $k_c$ tem valor significativo apenas quando o intervalo $\Delta \kappa$ é pequeno comparado a $k_c$.
 Partindo desse princípio, podemos definir uma envoltória que varia lentamente na coordenada espacial:
\begin{equation}
	\tilde{\mathcal{E}}(\omega,z) \equiv 2\tilde{E}^+(\omega + \omega_c, 0)e^{-i\Delta \kappa z}.
	\label{eq:3.27}
\end{equation}  
%Isso requer que
%\begin{equation}
%	\qty|\pdv{z}\tilde{\mathcal{E}}(\omega,z)| \ll k_c\qty|\tilde{\mathcal{E}}(\omega,z)|,
%	\label{eq:3.28}
%\end{equation}
%pois partimos do fato que:
%\begin{equation}
%	\qty|\frac{\Delta \kappa}{k_c}| \ll 1.
%	\label{eq:3.29}
%\end{equation}
Substituindo  \eqref{eq:3.27} em \eqref{eq:3.30}, temos:
\begin{eqnarray}
E^+(z,t) & = & \frac{1}{2}\qty[\frac{1}{2\pi}\int_{-\infty}^\infty d\omega \mathcal{\tilde{E}}(z,\omega)e^{i\omega t} ]  e^{iw_ct-ik_cz}
\nonumber\\& = & \frac{1}{2}\mathcal{\tilde{E}}(z,t)e^{i(w_ct-k_cz)}.
\label{eq:3.32}
\end{eqnarray}
onde $\mathcal{E}(z,t)$ é a envoltória do pulso que varia lentamente no espaço e no tempo.

Agora, precisamos obter uma expressão para $P^{L+}(z,t)$. Para isso, reescrevemos \eqref{eq:3.17} em termos de $\epsilon(\omega)$ e expandimos $\epsilon(\omega)$ em série de Taylor em torno de $\omega_c$, assim como fizemos para $k(\omega)$, de forma que:  
\begin{eqnarray}
\tilde{P}^{L+}(z,\omega) & = & \qty[\epsilon(\omega) - \epsilon_0]\tilde{E}^+(z, \omega)\nonumber\\& = & \left[\epsilon(\omega_c) + (\omega-\omega_c) \pdv{\epsilon}{\omega}\Big|_{\omega_c} + \frac{(\omega-\omega_c)^2}{2!} \pdv[2]{\epsilon}{\omega}\Big|_{\omega_c}\right. + \cdots +{}\nonumber\\& + & \left. \frac{(\omega-\omega_c)^n}{n!} \pdv[n]{\epsilon}{\omega}\Big|_{\omega_c} - \epsilon_0 \right]\tilde{E}^+(z, \omega)\nonumber\\& = & \qty[\epsilon(\omega_c) - \epsilon_0  + \sum_{n=1}^\infty \frac{(\omega-\omega_c)^n}{n!} \pdv[n]{\epsilon}{\omega}\Big|_{\omega_c}]\tilde{E}^+(z, \omega).
\label{eq:3.33}
\end{eqnarray}
Aplicando transformada de Fourier inversa à equação \eqref{eq:3.33}, temos:
\begin{eqnarray}
P^{L+}(z,t) & = & \frac{1}{2\pi} \int_{-\infty}^{\infty} d\omega \tilde{P}^{L+}(z,\omega) e^{i\omega t}\nonumber\\& = & \frac{1}{2\pi} \int_{-\infty}^{\infty} d\omega \qty[\epsilon(\omega_c) - \epsilon_0  + \sum_{n=1}^\infty \frac{(\omega-\omega_c)^n}{n!}\pdv[n]{\epsilon}{\omega}\Big|_{\omega_c}]\tilde{E}^+(z, \omega)e^{i\omega t}\nonumber\\& = & \frac{1}{2\pi} \int_{-\infty}^{\infty} d\omega\Bigg[\epsilon(\omega_c) - \epsilon_0 + \sum_{n=1}^\infty \frac{(\omega-\omega_c)^n}{n!} \pdv[n]{\epsilon}{\omega}\Big |_{\omega_c} \Bigg] \tilde{E}^+(0, \omega)e^{-ik_cz-i\Delta\kappa z }e^{i\omega t} \nonumber\\& = & \frac{1}{2\pi} \int_{-\infty}^{\infty} d\omega	\Bigg[\epsilon(\omega_c) - \epsilon_0  + \sum_{n=1}^\infty \frac{\omega^n}{n!} \pdv[n]{\epsilon}{\omega}\Big|_{\omega_c}\Bigg]\tilde{E}^+(0, \omega + \omega_c)e^{-ik_cz-i\Delta\kappa z}e^{i(\omega + \omega_c) t }\nonumber\\& = & \frac{1}{2\pi}\qty{ \int_{-\infty}^{\infty} d\omega	\Bigg[\epsilon(\omega_c) - \epsilon_0  + \sum_{n=1}^\infty \frac{\omega^n}{n!} \pdv[n]{\epsilon}{\omega}\Big|_{\omega_c}\Bigg]\tilde{E}^+(0, \omega + \omega_c)e^{-i\Delta\kappa z}e^{i\omega t}}e^{i\omega_c t -ik_cz}\nonumber\\
\label{eq:3.34}
\end{eqnarray}   

Substituindo \eqref{eq:3.27} em \eqref{eq:3.34} e fazendo a mudança de  notação $\pdv[n]{\epsilon}{\omega}\Big|_{\omega_c}= \epsilon^{(n)}(\omega_c)$ , obtemos:
\small
\begin{eqnarray}
P^{L+}(z,t) & = & \frac{1}{2} \qty{\frac{1}{2\pi} \int_{-\infty}^{\infty} d\omega \qty[\epsilon(\omega_c) - \epsilon_0  + \sum_{n=1}^\infty \frac{\epsilon^{(n)}(\omega_c)}{n!}\omega^n]\tilde{\mathcal{E}}(z, \omega)e^{i\omega t }}e^{i\omega_c t - ik_cz}\nonumber\\& = & \frac{1}{2} \qty{\frac{1}{2\pi}\int_{-\infty}^{\infty} d\omega \qty[\epsilon(\omega_c) - \epsilon_0  + \sum_{n=1}^\infty \frac{(-1)^n\epsilon^{(n)}(\omega_c)}{n!}\pdv[n]{t}]\tilde{\mathcal{E}}(z, \omega)e^{i\omega t }}e^{i\omega_c t - ik_cz}\nonumber\\& = & \frac{1}{2} \qty{ \qty[\epsilon(\omega_c) - \epsilon_0  + \sum_{n=1}^\infty \frac{(-1)^n\epsilon^{(n)}(\omega_c)}{n!}\pdv[n]{t}]\frac{1}{2\pi}\int_{-\infty}^{\infty} d\omega\tilde{\mathcal{E}}(z, \omega)e^{i\omega t }}e^{i\omega_c t - ik_cz}\nonumber\\& = & \frac{1}{2} \qty{ \qty[\epsilon(\omega_c) - \epsilon_0  + \sum_{n=1}^\infty \frac{(-1)^n\epsilon^{(n)}(\omega_c)}{n!}\pdv[n]{t}]\tilde{\mathcal{E}}(z, t)}e^{i\omega_c t - ik_cz}\nonumber\\& = & \frac{1}{2}\tilde{\mathcal{P}}^\mathcal{L}(z,t)e^{i\omega t - ik_cz},
\label{eq:3.35}
\end{eqnarray}
onde $\tilde{\mathcal{P}}^\mathcal{L+}(z,t)$ é a envoltória da polarização que varia lentamente em relação ao espaço e o tempo. O próximo passo é substituir o campo elétrico \eqref{eq:3.32} e a polarização \eqref{eq:3.35} na equação de propagação de onda \eqref{eq:3.14}. Assim, temos: 
\begin{eqnarray}
&&\qty[\pdv[2]{z} - 2ik_c\pdv{z} - {k_c}^2]\tilde{\mathcal{E}}(z,t) -  \frac{1}{c^2}\bigg[\pdv[2]{t} + 2i\omega_c\pdv{t} - {\omega_c}^2\bigg]\tilde{\mathcal{E}}(z,t)\nonumber\\&& =  \mu_0\bigg[\pdv[2]{t} + 2i\omega_c\pdv{t} - {\omega_c}^2\bigg]\tilde{\mathcal{P}}^\mathcal{L}(z,t)\nonumber\\\nonumber\\\nonumber\\&& \qty[\pdv[2]{z} - 2ik_c\pdv{z} - {k_c}^2]\tilde{\mathcal{E}}(z,t) -  \mu_0\epsilon_0\bigg[\pdv[2]{t} + 2i\omega_c\pdv{t} - {\omega_c}^2\bigg]\tilde{\mathcal{E}}(z,t) \nonumber\\&& =\frac{\mu_0}{2}\bigg[\pdv[2]{t} + 2i\omega_c\pdv{t} - {\omega_c}^2\bigg]\qty[\epsilon(\omega_c) - \epsilon_0  + \sum_{n=1}^\infty \frac{(-i)^n}{n!}\epsilon^{(n)}(\omega_c)\pdv[n]{t}]\tilde{\mathcal{E}}(z, t). 
\label{eq:3.36}
\end{eqnarray}
Levando em conta que $(c^2)^{-1} = \mu_0\epsilon_0$, temos:
\begin{eqnarray}
&&\qty[\pdv[2]{z} - 2ik_c\pdv{z} - {k_c}^2]\tilde{\mathcal{E}}(z,t) - {\color{red} \mu_0\epsilon_0\bigg[\pdv[2]{t} + 2i\omega_c\pdv{t} - {\omega_c}^2\bigg]\tilde{\mathcal{E}}(z,t)}  \nonumber\\ && = \mu_0\epsilon(\omega_c)\bigg[\pdv[2]{t} + 2i\omega_c\pdv{t} - {\omega_c}^2\bigg]\tilde{\mathcal{E}}(z,t) - {\color{red} \mu_0\epsilon_0\bigg[\pdv[2]{t} + 2i\omega_c\pdv{t} - }{\color{red}{\omega_c}^2\bigg]\tilde{\mathcal{E}}(z,t)} +\nonumber\\&& + \sum_{n=1}^\infty \frac{(-i)^n}{n!}\mu_0\epsilon^{(n)}(\omega_c)\bigg[\pdv[n+2]{t} +   2i\omega_c\pdv[n+1]{t}- {\omega_c}^2\pdv[n]{t}\bigg]\tilde{\mathcal{E}}(z,t)\nonumber\\\nonumber\\\nonumber\\&&\qty[\pdv[2]{z} - 2ik_c\pdv{z} - {k_c}^2]\tilde{\mathcal{E}}(z,t)  =  \mu_0\epsilon(\omega_c)\bigg[\pdv[2]{t} + 2i\omega_c\pdv{t} - {\omega_c}^2\bigg]\tilde{\mathcal{E}}(z, t)  - \nonumber\\ && -  i\mu_0\bigg[2i\omega_c\epsilon^{(1)}(\omega_c)\pdv[2]{t} -  {\omega_c}^2\epsilon^{(1)}(\omega_c)\pdv{t} +  \frac{i{\omega_c}^2\epsilon^{(2)}(\omega_c)}{2}\pdv[2]{t}\bigg]\tilde{\mathcal{E}}(z, t) - \nonumber\\&& -  \sum_{n=3}^\infty \frac{(-i)^{n}}{n!} \bigg[n(n-1)\mu_0\epsilon^{(n-2)}(\omega_c) +  2n\mu_0\omega_c\epsilon^{(n-1)}(\omega_c) + \mu_0{\omega_c}^2\epsilon^{(n)}(\omega_c)\bigg]\pdv[n]{t}\tilde{\mathcal{E}}(z, t).				 															
\label{eq:3.37}
\end{eqnarray}

Partindo do fato que ${k_c}^2=\mu_0\epsilon(\omega_c){\omega_c}^2$, temos
\begin{eqnarray}
&&\qty[\pdv[2]{z} - 2ik_c\pdv{z} - {\color{red}{k_c}^2}]\tilde{\mathcal{E}}(z,t)   =  - {\color{red}{k_c}^2\tilde{\mathcal{E}}(z,t)} + i\mu_0\omega_c\big[\omega_c\epsilon^{(1)}(\omega_c) + 2\epsilon(\omega_c)\big]\pdv{t}\tilde{\mathcal{E}}(z,t)\nonumber\\ && +  \mu_0\bigg[\epsilon(w_c) + 2\omega_c\epsilon^{(1)}(w_c) + \frac{{\omega_c}^2\epsilon^{(2)}(\omega_c)}{2}\bigg]\pdv[2]{t}\tilde{\mathcal{E}}(z,t) - \sum_{n=3}^\infty \frac{(-i)^{n}}{n!} \bigg[n(n-1)\mu_0\epsilon^{(n-2)}(\omega_c) + \nonumber\\&& + 2n\mu_0\omega_c\epsilon^{(n-1)}(\omega_c) +  \mu_0{\omega_c}^2\epsilon^{(n)}(\omega_c)\bigg]\pdv[n]{t}\tilde{\mathcal{E}}(z,t)\nonumber\\\nonumber\\\nonumber\\&&
\qty[\pdv[2]{z} - 2ik_c\pdv{z}]\tilde{\mathcal{E}}(z,t)   =  i\mu_0\omega_c\big[\omega_c\epsilon^{(1)}(\omega_c) + 2\epsilon(\omega_c)\big]\pdv{t}\tilde{\mathcal{E}}(z,t) +  \mu_0\bigg[\epsilon(w_c) + 2\omega_c\epsilon^{(1)}(w_c) + \nonumber\\&& +  \frac{{\omega_c}^2\epsilon^{(2)}(\omega_c)}{2}\bigg]\pdv[2]{t}\tilde{\mathcal{E}}(z,t) - \sum_{n=3}^\infty \frac{(-i)^{n}}{n!} \bigg[n(n-1)\mu_0\epsilon^{(n-2)}(\omega_c) + 2n\mu_0\omega_c\epsilon^{(n-1)}(\omega_c)\nonumber\\&& +  \mu_0{\omega_c}^2\epsilon^{(n)}(\omega_c)\bigg]\pdv[n]{t}\tilde{\mathcal{E}}(z,t).
\label{eq:3.38}
\end{eqnarray}

Agora, precisamos introduzir as grandezas velocidade de fase, velocidade de grupo e dispersão de velocidade de grupo que representam características importantes da propagação de onda eletromagnéticas. Quando tratamos de ondas do tipo 
\begin{equation}
	\Lambda(z,t) = Ae^{i(\omega t-kz)}
\end{equation}
onde a frequência é bem definida a velocidade, ao qual a forma da onda se propaga é chamada de velocidade fase $v_f$ e pode ser obtida  a partir da fase da onda $\phi = \omega t - kz$, pois $\phi$ é constante em qualquer tempo ou posição do espaço (mesmo em $z=\infty$ e $t=\infty$). Assim, temos:
\begin{eqnarray}
	d\phi = wdt-kdz=0.
\end{eqnarray}
Logo,
\begin{eqnarray}
	\dv{z}{t} = v_f = \frac{\omega}{k}.
\end{eqnarray}


Para ondas eletromagnéticas, como vemos em \eqref{eq:3.26}, $k=\omega n/c$. Assim,
\begin{equation}
	v_f = \frac{c}{n}
\end{equation}
Esse tipo de onda é idealizado, pois ondas eletromagnética tem duração finita e e possuem uma distribuição de frequências e é escrita da seguinte forma 
\begin{equation}
	\Lambda(z,t) = \sum_nA_ne^{i(\omega_n t-k_nz)}.
	\label{eq:onda}
\end{equation}
Assim, essa onda possui uma distribuição de velocidades de fases, e deixa de significado físico de velocidade da onda. Felizmente, esse tipo de onda Eletromagnética tem uma velocidade definida que chamamos de velocidade de grupo $v_g$. É complexo derivar essa velocidade de grupo a partir da expressão \eqref{eq:onda} quando temos uma distribuição grande de frequências. Por isso, usaremos a superposição de duas ondas com mesma amplitude, com frequências $\omega_1 = \omega-\Delta\omega$ e $\omega_2 = \omega+\Delta\omega$ e números de ondas $k_1 = k - \Delta k $ e $k_2 = k + \Delta k $, como exemplificado na figura \eqref{fig:superposicao}. De forma que:
\begin{eqnarray}
	\Lambda(z,t) &=& Ae^{i[(\omega-\Delta\omega)t-(k-\Delta k)z]} + Ae^{i[(\omega+\Delta\omega)t-(k+\Delta k)z]} \nonumber\\ &=& Ae^{i(\omega t - k z)}[e^{-i(\Delta\omega t - \Delta k z)} + e^{i(\Delta\omega t-\Delta kz)}]\nonumber\\ &=& 2Acos(\Delta\omega t-\Delta kz)e^{i(\omega t - k z)},
\end{eqnarray} 
onde a exponencial é o termo de propagação com velocidade $v_p = \omega/k = c/n(\omega)$. O cosseno é o termo que modula a equação de onda. Se supormos que  $\Delta\omega$ e $\Delta k$ são muito pequenos comparados a $\omega$ e $k$, respectivamente, a envoltória desse campo varia lentamente no espaço e no tempo, comparado ao temo de propagação. Assim, o termo de modulações  se propaga com velocidade
\begin{equation}
	v_g = \dv{\omega}{k} = \frac{\Delta \omega}{\Delta k}.
\end{equation}

\begin{sagesilent}
	t = var('t')
	z = var('z')
	A=1
	c=3e8
	w=4
	k=w/c
	dk=0.5
	dw=0.5
	
	f1(t,z)= A*exp(I*((w-dw)*t-(k-dk)*z))
	f2(t,z)= A*exp(I*((w+dw)*t-(k+dk)*z))
	f3(t,z)= 2*A*cos(dw*t-dk*z)*exp(I*(w*t-k*z))
	f4(t,z)=2*A*cos(dw*t-dk*z)
	
	D = plot(f4(t,0), t, -5, 5, linestyle="--", thickness=1, color='black') + plot(-f4(t,0), t, -5, 5, linestyle="--", thickness=1, color='black')
	
	E=plot(A, t, -5, 5, linestyle="--", thickness=1, color='black') + plot(-A, t, -5, 5, linestyle="--", thickness=1, color='black')
	
	O = plot(real_part(f1(t,0)),t,-5,5,frame=true,figsize=(6,3),thickness=1, color='blue',axes=False) + E
	
	B = plot(real_part(f2(t,0)),t,-5,5,frame=true,figsize=(6,3),thickness=1, color='red',axes=False) + E
	
	C = plot(real_part(f3(t,0)),t,-5,5,frame=true,figsize=(6,3),thickness=1, color='green',axes=False) + D
	
	
	O.set_axes_range(-5,5,-3,3)
	B.set_axes_range(-5,5,-3,3)
	C.set_axes_range(-5,5,-3,3)
	
\end{sagesilent}

\begin{figure}[H]
	\centering
	\caption{Representação da superposição de duas ondas plana, com $\omega = 4$ Hz, $\Delta w = 0.5$ Hz, $A=1$ e $z=0$.}
	\begin{tikzpicture}[node distance = 6cm, auto]
		\node (figura1) {\sageplot[scale=0.8]{O}};
		\node[below of=figura1] (figura2) {\sageplot[scale=0.8]{B}};
		\node[below of=figura2] (figura3) {\sageplot[scale=0.8]{C}};
		\node[rotate=90,above of= figura2,xshift=0.3cm ] {$E(z,t)$};
		\node[below of= figura3,yshift= 3cm, xshift=0.4cm ] {$t$ (s)};
		\node[right of = figura1,yshift= 2.4cm, xshift=-0.6cm] (labela) {(a)};
		\node[right of = figura2,yshift= 2.4cm, xshift=-0.6cm] (labelb) {(b)};
		\node[right of = figura3,yshift= 2.4cm, xshift=-0.6cm] (labelc) {(c)};	
	\end{tikzpicture}
	\label{fig:superposicao}
\end{figure}
A partir desse resultado podemos dizer que para o caso de sobreposição de um sistema infinito de ondas, onde  a frequências $\omega$  e numero de onda $k_c$ são continuamente distribuídas e variam em torno de uma frequência central $\omega_c$ e número de onda central $k_c$, que é o caso de um pulso eletromagnético, teremos de forma semelhante um termo de propagação  com velocidade de fase $v_f=c/n(w_c)$ e um termos de modulação que se propaga com velocidade 
\begin{equation}
	\frac{1}{v_g} = \dv{k(\omega)}{\omega}\Big|_{\omega_c}.
\end{equation}     
Essa é a fórmula correta da velocidade de grupo. A partir da definição de $k(\omega)$ em \eqref{eq:3.26} ,  temos que 
\begin{equation}
	\frac{1}{v_g}  = \frac{\mu_0\omega_c}{2k_c}\qty[\omega_c\epsilon^{(1)}(\omega_c) + 2\epsilon(\omega_c)] = \frac{n(\omega_c) + \omega_cn^{(1)}(\omega_{c})}{c}.
	\label{eq:3.39}
\end{equation}
Podemos ver que se o meio é não dispersivo ($n^{(1)}(\omega_c) = 0$), $v_g = v_f$. Para um meio dispersivo com $n^{(1)}(\omega_{c}) > 0$, $v_g<v_f$ e se $n^{(1)}(\omega_{c}) < 0$, $v_g > v_f$.

Outro conceito importante quando estamos tratando de pulsos eletromagnéticos, é a dispersão de velocidade de grupo (GVD), uma característica de um meio dispersivo que descreve como este meio altera a duração de um pulso eletromagnético ao se propagar por ele. A dispersão de velocidade de grupo é usualmente definida como
\begin{equation}
	k'' \equiv \pdv[2]{k}{\omega}\Big|_{\omega_c} = \pdv{\omega}\qty(\frac{1}{v_g})_{\omega_c} = -\frac{1}{k_c{v_g}^2}+ \frac{\mu_0}{k_c}\qty[\epsilon(w_c) + 2\omega_c\epsilon^{(1)}(w_c) + \frac{{\omega_c}^2\epsilon^{(2)}(\omega_c)}{2}].
	\label{eq:3.40}
\end{equation}
No final dessa Seção apresentamos, como exemplo, efeitos da GVD em um pulso gaussiano. 

Substituindo \eqref{eq:3.39} e \eqref{eq:3.40} em \eqref{eq:3.38}, obtemos:
\begin{eqnarray}
&&\qty[\pdv[2]{z} - 2ik_c\pdv{z} ]\tilde{\mathcal{E}}(z,t)  =  \frac{2ik_c}{v_g}\pdv{t}\mathcal{E}(z,t)\nonumber + k_ck''\pdv[2]{t}\tilde{\mathcal{E}}(z,t) + \frac{1}{{v_g}^2}\pdv[2]{t}\tilde{\mathcal{E}}(z,t) - \nonumber\\  && -  \sum_{n=3}^\infty \frac{(-i)^{n}}{n!} \bigg[n(n-1)\mu_0\epsilon^{(n-2)}(\omega_c) + 2n\mu_0\omega_c\epsilon^{(n-1)}(\omega_c) +   \mu_0{\omega_c}^2\epsilon^{(n)}(\omega_c)\bigg]\pdv[n]{t}\tilde{\mathcal{E}}(z,t)\nonumber\\\nonumber\\\nonumber\\ &&\qty[\pdv[2]{z} - 2ik_c\pdv{z} ]\tilde{\mathcal{E}}(z,t)  =  \qty[\frac{1}{{v_g}^2}\pdv[2]{t} + \frac{2ik_c}{v_g}\pdv{t}]\tilde{\mathcal{E}}(z,t) + k_ck''\pdv[2]{t}\tilde{\mathcal{E}}(z,t) + \nonumber\\  && -  \sum_{n=3}^\infty \frac{(-i)^{n}}{n!} \bigg[n(n-1)\mu_0\epsilon^{(n-2)}(\omega_c) + 2n\mu_0\omega_c\epsilon^{(n-1)}(\omega_c) +  \mu_0{\omega_c}^2\epsilon^{(n)}(\omega_c)\bigg]\pdv[n]{t}\tilde{\mathcal{E}}(z,t).\nonumber\\
\label{eq:3.41}
\end{eqnarray}

Partindo da aproximação no qual 
\begin{equation}
\qty|\pdv[2]{z}\tilde{\mathcal{E}}(z,t)|\ll k_c\qty|\pdv{z}\tilde{\mathcal{E}}(z,t)|
\label{eq:3.42}
\end{equation}
e
\begin{equation}
\qty|\pdv[2]{t}\tilde{\mathcal{E}}(z,t)|\ll \omega_c\qty|\pdv{t}\tilde{\mathcal{E}}(z,t)|,
\label{eq:3.43}
\end{equation}
finalmente reduzimos a equação de propagação de onda \eqref{eq:3.41} à:
\begin{equation}
\pdv{z}\tilde{\mathcal{E}}(z,t) + \frac{1}{v_g}\pdv{t}\tilde{\mathcal{E}}(z,t) - \frac{ik''}{2}\pdv[2]{t}\tilde{\mathcal{E}}(z,t) + \mathcal{D} = 0
\label{eq:3.44}
\end{equation}
onde $k_c''$ é o termos de dispersão de velocidade de grupo GVD (Group Velocity Dispersion) e
\begin{equation}
\mathcal{D} = \frac{i\mu_0}{2k_c}\sum_{n=3}^\infty \frac{(-i)^{n}}{n!} \bigg[n(n-1)\epsilon^{(n-2)}(\omega_c) + 2n\omega_c\epsilon^{(n-1)}(\omega_c) + {\omega_c}^2\epsilon^{(n)}(\omega_c)\bigg]\pdv[n]{t}\tilde{\mathcal{E}}(z,t) 
\label{eq:3.45}
\end{equation}  
é o termo que representa a dispersão de ordem superior. Não temos interesse de resolver a equação \eqref{eq:3.44}. Apenas utilizaremos essa aproximação para derivar a equação para o meio atômico na aproximação de dois níveis na Seção \ref{sec:naolinear}. 

Para comprendermos efeitos da dispersão de velocidade grupo em um meio linear, faremos um exemplo simples, onde consideramos um pulso eletromagnético com formato gaussiano na posição inicial de forma que:
\begin{equation}
	E^+(z=0,t) = e^{-(t/T)^2}e^{i\omega_ct}.
\end{equation}
Realizando transformada de Fourier nessa equação, obtemos
 \begin{eqnarray}
 	E^+(z=0,w) &=& \int_{-\infty}^{\infty}dte^{-(t/T)^2}e^{-i(\omega-\omega_c)t}\nonumber\\
 	&=&e^{-\frac{T^2(\omega-\omega_c)^2}{4}}\int_{-\infty}^{\infty}dte^{-\qty[\frac{t}{T} + \frac{T(\omega-\omega_c)}{2}]^2}\nonumber\\&=& \sqrt{\pi}Te^{-\frac{T^2(\omega-\omega_c)^2}{4}}.
 \end{eqnarray}
Substituindo esse resultado em \eqref{eq:3.21}, temos que 
\begin{equation}
		E^+(z,w) = \sqrt{\pi}Te^{-\frac{(\omega-\omega_c)^2}{4}}e^{-ik(\omega)z}
\end{equation}
Realizando transformada de Fourier inversa a equação e considerando apenas o três primeiros termos da expansão \eqref{eq:3.24}, temos que
\begin{eqnarray}
	E^+(z,t) &=&\frac{1}{2\pi} \int_{-\infty}^{\infty}dt\sqrt{\pi}Te^{-\frac{T^2[\omega-\omega_c]^2}{4}}e^{-ik(\omega)z}e^{i\omega t}\nonumber\\&=&\frac{T}{2\sqrt{\pi}} \int_{-\infty}^{\infty}dte^{-\frac{T^2[\omega-\omega_c]^2}{4}}e^{-i\{k(\omega_c) + k'(\omega_c)[\omega - \omega_c] + k''(\omega_c)[\omega - \omega_c]^2\}z}e^{i\omega t}\nonumber\\&=&\frac{T}{2\sqrt{\pi}}e^{i[\omega_c t -k(\omega_c)z]} \int_{-\infty}^{\infty}dte^{-\frac{T^2[\omega-\omega_c]^2}{4}}e^{-i\{k'(\omega_c)[\omega - \omega_c] + k''(\omega_c)[\omega - \omega_c]^2\}z}e^{i[\omega-\omega_c] t}\nonumber\\&=&\frac{T}{2\sqrt{\pi}}e^{i[\omega_c t -k(\omega_c)z]} \int_{-\infty}^{\infty}dte^{-[\frac{T^2}{4} + \frac{ik''(\omega_c)z}{2}][\omega-\omega_c]^2-i[k'(\omega_c)z - t][\omega - \omega_c]}.
\end{eqnarray}
Fazendo as substituições
\begin{eqnarray}
	x &=& \sqrt{\frac{T^2}{4} + \frac{ik''(\omega_c)z}{2}}[\omega-\omega_c]\nonumber\\
	a &=& \frac{i[k'z - t]}{\sqrt{T^2 + 2ik''(\omega_c)z}},
\end{eqnarray}
simplificamos a equação à
\begin{eqnarray}
	E^+(z,t) &=&\frac{T}{\sqrt{\pi}\sqrt{T^2 + 2ik''(\omega_c)z}}e^{i[\omega_c t -k(\omega_c)z]} \int_{-\infty}^{\infty}dte^{-x^2-2ax}\nonumber\\&=&\frac{T}{\sqrt{\pi}\sqrt{T^2 + 2ik''(\omega_c)z}}e^{i[\omega_c t -k(\omega_c)z]} \int_{-\infty}^{\infty}dte^{-\{[x+a]^2 - a^2\}}\nonumber\\
	&=&\frac{T}{\sqrt{T^2 + 2ik''(\omega_c)z}}e^{a^2}e^{i[\omega_c t -k(\omega_c)z]}.
\end{eqnarray}

Na figura \ref{fig:gvd}, como exemplo, temos dois gráficos que apresentam o perfil de um pulso eletromagnético gaussiano que se propaga por dois meios dispersivos. Veja que a largura do pulso aumenta ao se propagar pelo meio e sua amplitude diminui. Observe, também que para meio com $k''>0$ (GVD positivo) a frequência aumenta para tempos posteriores. Assim, um observador fixo vê frequências mais baixas chegando primeiro. Para meio com $k''<0$ (GVD negativo), a frequência diminue para tempo posteriores. Logo, o observador vê frequência maiores no pulso chegando primeiro.

\begin{sagesilent}
	t = var('t')
	k11 = var('k11')
	Tp=1
	w=5
	c=3e8
	kk=w/c
	k1=w/kk
	z=0.000001
	f(t,k11)= (Tp/sqrt(Tp^2 + I*2*k11*z))*exp(-(t)^2/(Tp^2 + I*2*k11*z))*exp(I*(w*(t+k1*z)-kk*z))
	
	f1 = real_part(f)
	
	A = plot(f1(t,0),t,-10,10,frame=true,figsize=(6,3),thickness=1, color='green',axes=False)
	B = plot(f1(t,2e6),t,-10,10,frame=true,figsize=(6,3),thickness=1, color='red',axes=False)
	C = plot(f1(t,-2e6),t,-10,10,frame=true,figsize=(6,3),thickness=1, color='blue',axes=False)
	
	A.set_axes_range(-10,10,-1.2,1.2)
	B.set_axes_range(-10,10,-1.2,1.2)
	C.set_axes_range(-10,10,-1.2,1.2)
	
	D = graphics_array([[A],[B],[C]])

		
\end{sagesilent}



\begin{figure}[H]
	\centering
	\caption{Propagação  de um pulso gaussiano (a) em meios dispersivo. Pulso eletromagnético caracterizado por uma meio com $k''$ positivo (b) e $k''$ negativo (c).}
	\begin{tikzpicture}[node distance = 6cm, auto]
	\node (figura1) {\sageplot[scale=0.8]{A}};
	\node[below of=figura1] (figura2) {\sageplot[scale=0.8]{B}};
	\node[below of=figura2] (figura3) {\sageplot[scale=0.8]{C}};
	\node[rotate=90,above of= figura2 ] {$E(z,t)$};
	\node[below of= figura3,yshift= 3cm, xshift=0.4cm ] {Tempo};
	\node[right of = figura1,yshift= 2.4cm, xshift=-0.6cm] (labela) {(a)};
	\node[right of = figura2,yshift= 2.4cm, xshift=-0.6cm] (labelb) {(b)};
	\node[right of = figura3,yshift= 2.4cm, xshift=-0.6cm] (labelc) {(c)};	
	\end{tikzpicture}
	\label{fig:gvd}
\end{figure}
 
%\sageplot[scale=0.8]{D, figsize=(6,8), axes_labels = ("Tempo","$E(z,t)$")}

\section{Propagação de onda em um meio não linear}\label{sec:naolinear}

A discussão sobre propagação de onda  na Seção \ref{sec:linear} se limitava a interação com meios lineares. Porém, o que nos interessa neste TCC é descrever a interação de campo elétrico com meio atômico de dois níveis, que possui polarização não linear em ressonância com o campo elétrico. Assumindo que esses átomos estão envoltos de um material transparente em que o campo obedece a equação \eqref{eq:3.44}. Desta forma, podemos complementar a equação \eqref{eq:3.44} adicionando a polarização do meio atômico não linear, definindo que essa polarização também pode ser decomposta em uma envoltória que varia lentamente no tempo e no espaço e outra contribuição que oscila rapidamente:
\begin{equation}
P^{NL}(z,t) \equiv \frac{1}{2}\mathcal{\tilde{P}}^{NL}(z,t)e^{iw_ct-ik_cz} + c.c.
\label{eq:3.46}
\end{equation}
Assim, obtemos a seguinte equação de propagação:
\begin{equation}
\pdv{z}\tilde{\mathcal{E}}(z,t) + \frac{1}{v_g}\pdv{t}\tilde{\mathcal{E}}(z,t) - \frac{ik_c''}{2}\pdv[2]{t}\tilde{\mathcal{E}}(z,t) + \mathcal{D} = \frac{i\mu_0}{2k_c}\qty(\pdv[2]{t}+2i\omega_c\pdv{t} - {\omega_c}^2)\tilde{\mathcal{P}}^{NL}(z,t).\label{eq:3.47}
\end{equation}
Como estamos interessados em efeito não lineares da matéria, consideramos que o meio transparente que envolve a amostra tem $k''$ e $D$ desprezíveis. Assim, fazemos $k_c''= \mathcal{D} = 0$. Outra simplificação é feita considerando o fato que
\begin{equation}
\qty|\pdv[2]{t}\tilde{\mathcal{P}}^{NL}(z,t)| \ll \omega_c\qty|\pdv[]{t}\tilde{\mathcal{P}}^{NL}(z,t)| \ll {\omega_c}^2\qty|\tilde{\mathcal{P}}^{NL}(z,t)|.
\label{eq:3.48}
\end{equation}  
Dessa maneira, obtemos a seguinte aproximação para equação de onda:
\begin{equation}
\pdv{z}\tilde{\mathcal{E}}(z,t) + \frac{1}{v_g}\pdv{t}\tilde{\mathcal{E}}(z,t) = -\frac{i\mu_0}{2k_c}{\omega_c}^2\tilde{\mathcal{P}}^{NL}(z,t).
\label{eq:3.49}
\end{equation}

Por conveniência, vamos fazer uma mudança para um sistema de coordenadas ($\eta, \tau$) movendo-se com a velocidade do grupo $v_g = \qty(\dv{k}{\omega}\Big|_{w_c})^{-1}$, como exemplificado na figura \ref{fig:referencial}, realizando as seguintes trocas de variáveis:
\begin{equation}
\eta = z~~~~~~~\tau = t-\frac{z}{v_g}
\label{eq:3.50}
\end{equation}
e
\begin{equation}
\pdv{z} = \pdv{\eta} - \frac{1}{v_g}\pdv{\tau}~~~~~~~\pdv{t} = \pdv{\tau}.
\label{eq:3.51}
\end{equation}
Desse modo, podemos reescrever  a  equação\eqref{eq:3.47} da seguinte forma:  
\begin{equation}
	\pdv{\eta}\tilde{\mathcal{E}}(\eta,\tau)  = -\frac{i\mu_0}{2k_c}{\omega_c}^2\tilde{\mathcal{P}}^{NL}(\eta,\tau).
	\label{eq:3.52}
\end{equation}
\begin{sagesilent}
	Tp=1
	c=3e8
	k1=1/c
	
	f(t,z) = exp(-(k1*z-t)^2/Tp^2)
	f2(t,z) = exp(-(t)^2/Tp^2)
	
	A=contour_plot(f(t,z),(t,-2,4),(z,0,10e8),frame=true,thickness=1, color='green',axes=False, colorbar=true,cmap='jet',plot_points=150,contours=100,aspect_ratio='automatic')
	p = A[0]
	opt = p.options()
	print(opt)
	opt['colorbar_options']
	opt['colorbar_options']['label'] = '$\mathcal{E}(z,t)$'
	p.set_options(opt)
	A[0] = p
	B=contour_plot(f2(t,z),(t,-2,4),(z,0,10e8),frame=true,thickness=1, color='green',axes=False, colorbar=true,cmap='jet',plot_points=150,contours=100,aspect_ratio='automatic')
	p = B[0]
	opt = p.options()
	print(opt)
	opt['colorbar_options']
	opt['colorbar_options']['label'] = '$\mathcal{E}(\eta,\\tau)$'
	p.set_options(opt)
	B[0] = p
	A.show()
	
\end{sagesilent}





\begin{figure}[ht]
	\centering
	\caption{O primeiro gráfico representa um pulso em um referencial em repouso e o segundo representa um pulso no referencial com velocidade $v_g$ }
	\sageplot[scale=0.62]{A, axes_labels=("$t$ (s)","$z$ (m)"), figsize=(5,4)}\sageplot[scale=0.62]{B, axes_labels=("$\\tau$ (s)","$\eta$ (m)"), figsize=(5,4)}
	\label{fig:referencial}
\end{figure}
Este resultado final é a equação de onda em sua forma reduzida, que permite descrever o comportamento da propagação do campo eletromagnético através de um certo meio atômico. Ela será aplicada no Capítulo \ref{cap:maxwellbloch} para um meio atômico de dois níveis.

\chapter{Mecânica Quântica e Operador Densidade}\label{cap:capitulo2}

%Para cada capítulo adicional, digite o comando \chapter{Título do Capítulo}

Neste capítulo nos dedicamos a apresentar o formalismo do operador densidade, desenvolvido por J. von Neumann em 1927, e suas vantagens em relação à representação de autoestados e autovetores no estudo de sistemas quânticos \cite{sakurai2013mecanica}.

\section{Matriz densidade}
\label{secao2.1}

A mecânica quântica assumimos que as propriedades quânticas de um sistema é dado pela função de onda que no formalismo de dirac (auto valores e auto estado) é representada da seguinte forma:
\begin{equation}
	\ket{\psi(t)} = \sum_n c_n(t) \ket{n}
\end{equation}
onde $\ket{n}$ é um auto estado no espaço de Hilbert de um determinado observável A , $c_n$ é amplitude de probabilidade que pondera a possibilidade de encontrarmos o observável A neste estado. A evolução temporal da função de onda $\ket{\psi(t)}$ é dada pela equação de Shr\"{o}dinger
\begin{equation}
	i\hbar\pdv{t}\ket{\psi_i(t)} = \hat{H}\ket{\psi_i(t)}.
	\label{eq:25}
\end{equation}

Nesse formalismo, conseguimos fazer previsões sobre um conjunto de sistemas físicos preparados de forma idêntica \cite{breuer2002theory}. Em termos mais específicos, garantimos que todos os sistemas membros deste ensemble sejam caracterizados por um mesmo ket de estado $\ket{\psi}$ ( Ensemble puro ). Diante dessa construção, este formalismo não é válido se considerarmos, por exemplo, que $70\%$ desses sistemas são caracterizados pelo ket de estado $\ket{\psi_1}$ e $30\%$ pelo ket de estado $\ket{\psi_2}$ ( ensemble misto ). Para lidar com essa nova situação, precisamos introduzir o conceito de operador densidade, que nos permitirá descrever quantitativamente conjuntos de sistemas quântico para ensemble puros e ensemble misto. 

Consideremos o ensemble misto, onde uma fração de sistemas com população relativa $w_1$ estão no estado $\ket{\psi_1}$; outra fração $w_2$ estão no estado $\ket{\psi_2}$, e assim sucessivamente. Podemos dizer, com certa precisão, que um ensemble misto pode ser visto como uma mistura de ensembles puros. As populações $w_i$ devem satisfazer a condição de normalização, ou seja,
\begin{equation} 
	\sum_i w_i = 1.
	\label{eq:1} 
\end{equation}

Não é necessário que $\ket*{\psi_1}$, $\ket*{\psi_2}$,..., $\ket*{\psi_i}$ sejam ortogonais entre si e o número de termos na soma em $i$ na equação \eqref{eq:1} não precisa ser igual ao número de dimensões $N$ no espaço de Hilbert. Exemplo: Supondo dois estados $\ket{\psi_1}$ e $\ket{\psi_2}$ com valores
\begin{equation}
	\ket{\psi_1} = \ket{1}\nonumber
\end{equation}
e
\begin{equation}
	\ket{\psi_2} = \frac{1}{\sqrt{2}}\ket{1} +\frac{1}{\sqrt{2}}\ket{2},\nonumber
\end{equation}
podemos verificar que não são ortogonais entre si, pois
\begin{eqnarray}
	\braket{\psi_1}{\psi_2} &=& \bra{1}.\frac{1}{\sqrt{2}}\ket{1} +\bra{2}0.\frac{1}{\sqrt{2}}\ket{2}\nonumber\\&=& \frac{1}{\sqrt{2}}.\nonumber
\end{eqnarray}


Em um ensemble puro, o valor esperado de um observável  $\hat{A}$ é dado por 
\begin{equation}
	<A> =  \mel{\psi}{\hat{A}}{\psi}.
\end{equation}
Para o caso mistos podemos obter o valor média de $A$, através da soma dos valores esperados para $A$ em cada $\ket{\psi_i}$, ponderado pela população relativa $w_i$ deste estado. Assim essa média é definida por:
\begin{eqnarray}
	<\hat{A}> & \equiv & \sum_i w_i <A>_{\psi_i}\nonumber\\
			  & = & \sum_i w_i \mel{\psi_i}{\hat{A}}{\psi_i}\nonumber\\
	   	      & = & \sum_i w_i \mel{\psi_i}{\hat{A}\qty(\sum_{n} \dyad{n}{n}) }{\psi_i}\nonumber\\
	   	      & = & \sum_i \sum_{n} w_i \mel{\psi_i}{\hat{A}}{n}\braket{n}{\psi_i} \nonumber\\
	   	      & = & \sum_i \sum_{n} w_i \braket{\psi_i}{n}\braket{n}{\psi_i}n \nonumber\\
	   	      & = & \sum_i \sum_{n} w_i \braket{n}{\psi_i}^*\braket{\psi_i}{n}n \nonumber\\
	   	      & = & \sum_i \sum_{n} w_i \qty|\braket{n}{\psi_i}|^2n, 
	\label{eq:2} 
\end{eqnarray}
sendo que $\ket{n}$ é um autovetor do operador $\hat{A}$ (com autovalor $n$ ) e que $\mel{\psi_i}{\hat{A}}{\psi_i}$ trata-se do valor esperado habitual para $\hat{A}$ em relação a um estado $\ket{\psi_i}$. Vemos na equação \eqref{eq:2} que este valores esperados são ponderados pelas populações relativas $w_i$. É possível observar também que $\qty|\braket*{n}{\psi_i}|^2$ é a probabilidade do estado $\ket*{\psi_i}$ de ser colapsado em um autoestado $\ket*{n}$ após uma medida em $\hat{A}$ e que $w_i$ identifica a quantidade relativa de sistemas no estado estado quântico caracterizado por $\ket*{\psi_i}$.  

Se considerarmos uma base genérica \{$\ket*{n}$, $\ket*{m}$\}, podemos reescrever a média sobre o ensemble \eqref{eq:2} da seguinte forma:
\begin{eqnarray} 
	<\hat{A}> & = & \sum_i w_i \mel{\psi_i}{\qty(\sum_{n} \dyad{n}{n})\hat{A}\qty(\sum_{m} \dyad{m}{m}) }{\psi_i}\nonumber\\
			  & = & \sum_i \sum_{n} \sum_{m} w_i \braket{\psi_i}{n}\mel{n}{\hat{A}}{m}\braket{m}{\psi_i} \nonumber\\
			  & = & \sum_i \sum_{n} \sum_{m} w_i \braket{m}{\psi_i}\braket{\psi_i}{n}\mel{n}{\hat{A}}{m} \nonumber\\
			  & = & \sum_{n} \sum_{m} \qty( \sum_i w_i \braket{m}{\psi_i}\braket{\psi_i}{n})\mel{n}{\hat{A}}{m}.
	\label{eq:3}
\end{eqnarray}

O termo destacado entre parenteses é o elemento de matriz de um certo operador hermitiano, que denominamos \textbf{matriz densidade} ou ainda, \textbf{operador densidade} $\hat{\rho}$, conforme equações \eqref{eq:4} e \eqref{eq:5}:
\begin{equation}
	\mel{m}{\hat{\rho}}{n} = \sum_i w_i \braket{m}{\psi_i}\braket{\psi_i}{n}
	\label{eq:4}
\end{equation}
De forma geral, o operador densidade é definido como  
\begin{equation}
	\hat{\rho} \equiv \sum_i w_i \dyad{\psi_i}{\psi_i}.
	\label{eq:5}
\end{equation} 

Uma vez determinado o operador densidade do sistema, podemos caracterizar o ensemble quântico em questão de modo a obter todas as informações físicas encerradas por tal operador. Substituindo \eqref{eq:4} em \eqref{eq:3}, podemos reescrever o valor esperado de $\hat{A}$ como:
\begin{eqnarray}
	<\hat{A}> & = & \sum_{n} \sum_{m} \mel{m}{\hat{\rho}}{n}\mel{n}{\hat{A}}{m}\nonumber\\
			  & = & \Tr(\hat{\rho}\hat{A}),
	\label{eq:6} 
\end{eqnarray}
onde a operação $Tr(\hat{\rho}\hat{A})$ corresponde ao traço do operador resultante do produto entre $\hat{\rho}$ e $\hat{A}$, ficando assim explícito o poder desta construção, pois o traço independe da representação e pode ser calculado usando uma base conveniente.

\subsection{Propriedades do Operador Densidade}

Vamos agora nos ater a algumas propriedades do operador densidade:

\textbf{Primeira propriedade:} O operador densidade é hermitiano, ou seja:
\begin{equation}
	\hat{\rho} = \hat{\rho}^\dag.
	\label{eq:7}
\end{equation} 

\textbf{Segunda propriedade:} O operador densidade satisfaz a condição de normalização 
\begin{eqnarray}
	\Tr\rho & = & \sum_i \sum_{n} w_i \braket{n}{\psi_i}\braket{\psi_i}{n}\nonumber\\
		    & = & \sum_i w_i \braket{\psi_i}{\psi_i}\nonumber\\
		    & = & 1.
	\label{eq:8}
\end{eqnarray}

\textbf{Terceira propriedade:} Podemos substituir o operador $\hat{A}$ em \eqref{eq:6} pelo próprio operador densidade, obtendo: 
\begin{eqnarray}
	\Tr(\hat{\rho}^2) & = & \Tr(\hat{\rho}\hat{\rho})\nonumber\\
					  & = & \sum_{n} \sum_{m} \mel{m}{\hat{\rho}}{n}\mel{n}{\hat{\rho}}{m}\nonumber\\
					  & = & \sum_{n} \sum_{m} \mel{m}{\qty( \sum_i w_i \dyad{\psi_i}{\psi_i})}{n}\mel{n}{\qty( \sum_j w_j \dyad{\psi_j}{\psi_j})}{m}\nonumber\\
					  & = & \sum_i \sum_j w_i w_j \braket{\psi_i}{\psi_j}\braket{\psi_j}{\psi_i}\nonumber\\
					  & = & \sum_i \sum_j w_i w_j \braket{\psi_i}{\psi_j}\braket{\psi_i}{\psi_j}^*\nonumber\\
					  & = & \sum_i \sum_j w_i w_j \norm{\braket{\psi_i}{\psi_j}}^2.
	\label{eq:9}
\end{eqnarray}
Esse resultado pode ser analisado observando a desigualdade de Cauchy-Schwarz \cite{cohen2019quantum}
\begin{equation}
	\norm{\braket{\psi_i}{\psi_j}}^2 \leq \braket{\psi_i}{\psi_i}\braket{\psi_j}{\psi_j}.
	\label{eq:10}
\end{equation} 
Como os kets $\ket*{\psi_i}$ são normalizados, ou seja, $\braket*{\psi_i}{\psi_i}=\braket*{\psi_j}{\psi_j} =1$, obtemos a seguinte propriedade:
\begin{equation}
	\Tr(\hat{\rho}^2) \leq 1.
	\label{eq:11}
\end{equation}

É possível observar que quando se trata de um ensemble puro, ou seja, quando um dos pesos $w_i$ tem valor 1 e o restante de valor 0, então
\begin{equation}
	\hat{\rho} = \dyad{\psi}{\psi}.
	\label{eq:12}
\end{equation}
Nesse caso, $\Tr(\hat{\rho}^2)$ tem valor máximo, isto é,
\begin{equation}
	\Tr(\hat{\rho}^2) = 1.
	\label{eq:13}
\end{equation} 
Assim, é fácil provar que o operador densidade de um ensemble puro é idempotente, ou seja:
\begin{equation}
	\hat{\rho}^2 = \hat{\rho}
	\label{eq:14}
\end{equation} 

Para melhor compreensão dessas propriedades, vamos supor, por exemplo, um sistema de dois níveis onde o operador densidade é dado pela matriz
\begin{equation}\label{eq:15}
	\hat{\rho} = \mqty(\rho_{11} & \rho_{12} \\ \rho_{21} & \rho_{22}).
\end{equation}  
No primeiro caso, consideramos que $100\%$ dos sistemas estão no ket estado $\ket{\psi}$, onde
\begin{equation}
	\ket{\psi} = \frac{1}{\sqrt{2}}\ket{0} + \frac{1}{\sqrt{2}}\ket{1},
	\label{eq:16}
\end{equation}
sendo que $\ket{0}$ e $\ket{1}$ são auto estados de um certo operador $\hat{H}$. Então, calculamos:
\begin{eqnarray}
	\hat{\rho} & = & \dyad{\psi}{\psi}\nonumber\\ 
			   & = & \qty(\frac{1}{\sqrt{2}}\ket{0} + \frac{1}{\sqrt{2}}\ket{1})\times\qty(\frac{1}{\sqrt{2}}\bra{0} + \frac{1}{\sqrt{2}}\bra{1})\nonumber\\
			   & = & \frac{1}{2}\qty(\dyad{0}{0} + \dyad{0}{1} + \dyad{1}{0} + \dyad{1}{1})\nonumber\\
			   & = & \mqty(\frac{1}{2} & \frac{1}{2} \\\\ \frac{1}{2} & \frac{1}{2}).
	\label{eq:17}
\end{eqnarray}
Neste caso, é fácil observar que $\hat{\rho}$ satisfaz condição de normalização e, como esperado, representa um caso puro, pois

\begin{eqnarray}
	\Tr(\hat{\rho}^2) 
					  & = & \Tr{\mqty(\frac{1}{2} & \frac{1}{2} \\\\ \frac{1}{2} & \frac{1}{2})\times\mqty(\frac{1}{2} & \frac{1}{2} \\\\ \frac{1}{2} & \frac{1}{2})} \nonumber\\
					  & = & \Tr{\mqty(\frac{1}{2} & \frac{1}{2} \\\\ \frac{1}{2} & \frac{1}{2})} \nonumber\\
					  & = & \Tr(\hat{\rho})\nonumber\\
					  & = & 1
	\label{eq:18}
\end{eqnarray} 

Em um segundo caso, temos que $50\%$ dos sistemas estão no ket estado $\ket{\psi}$ \eqref{eq:16} e $50\%$ estão no ket estado $\ket{\psi'}$, onde
\begin{equation}
	\ket{\psi'} = \frac{1}{\sqrt{2}}\ket{0} - \frac{1}{\sqrt{2}}\ket{1}.
	\label{eq:19}
\end{equation}
Assim temos:
\begin{eqnarray}
	\hat{\rho} 
				& = & \frac{1}{2}\dyad{\psi}{\psi} + \frac{1}{2}\dyad{\psi'}{\psi'} \nonumber\\
				& = & \frac{1}{2}\qty(\frac{1}{\sqrt{2}}\ket{0} + \frac{1}{\sqrt{2}}\ket{1})\times\qty(\frac{1}{\sqrt{2}}\bra{0} + \frac{1}{\sqrt{2}}\bra{1}) \nonumber\\
				& + & \frac{1}{2}\qty(\frac{1}{\sqrt{2}}\ket{0} - \frac{1}{\sqrt{2}}\ket{1})\times\qty(\frac{1}{\sqrt{2}}\bra{0} - \frac{1}{\sqrt{2}}\bra{1})\nonumber\\
				& = & \frac{1}{2}\qty(\dyad{0}{0} + \dyad{1}{1})\nonumber\\
				& = & \mqty(\frac{1}{2} & \frac{0}{0} \\\\ \frac{0}{0} & \frac{1}{2}).
	\label{eq:20}
\end{eqnarray}

O segundo caso também obedece a condição de normalização, mas diferente do primeiro caso, se trata de ensemble misto, pois
\begin{eqnarray}
	\Tr(\hat{\rho}^2) 
					  & = & \Tr{\mqty(\frac{1}{2} & 0 \\\\ 0 & \frac{1}{2})\times\mqty(\frac{1}{2} & 0 \\\\ 0 & \frac{1}{2})} \nonumber\\
					  & = & \Tr{\mqty(\frac{1}{4} & 0 \\\\ 0 & \frac{1}{4})} \nonumber\\
					  & = & \frac{1}{2},
	\label{eq:21}
\end{eqnarray} 
ou seja,

\begin{eqnarray}
	\Tr(\hat{\rho}^2) & < & 1.
	\label{eq:22}
\end{eqnarray} 

\subsection{Evolução Temporal do Operador Densidade}

Agora, precisamos determinar como o operador densidade evolui no tempo. Para isso, devemos supor que para um instante $t=t_0$ o operador densidade corresponde à
\begin{equation}
	\hat{\rho}(t_0) = \sum_i w_i \dyad{\psi_i(t_0)}{\psi_i(t_0)}.
	\label{eq:23}
\end{equation}
Consideremos que o ensemble não sofre pertubação conforme evolui no tempo, ou seja, as populações relativas $w_i$ se mantém estáticas. Assim, a alteração de $\hat{\rho}$ acontece unicamente pela evolução temporal dos kets de estado $\ket{\psi_i(t_0)}$.
\begin{equation}
	\ket{\psi_i(t_0)} \xrightarrow{\textrm{evolução temporal}} \ket{\psi_i(t)}
	\label{eq:24}
\end{equation}
Sabemos que $\ket{\psi_i(t)}$ satisfaz equação de Schrödinger \eqref{eq:25}, então podemos derivar a equação \eqref{eq:23} em relação ao tempo $t$ de modo que:
\begin{eqnarray}
	\pdv{t}\hat{\rho}(t) 
						& = &\pdv{t} \sum_i w_i \dyad{\psi_i(t)}{\psi_i(t)}\nonumber\\
						&= &\sum_i w_i \pdv{t}(\ket{\psi_i(t)})\bra{\psi_i(t)} + \sum_i w_i \ket{\psi_i(t)}\pdv{t}(\bra{\psi_i(t)}).
	\label{eq:26}
\end{eqnarray}

Substituindo \eqref{eq:25} em \eqref{eq:26}, obtemos a equação
\begin{eqnarray}
	\pdv{t}\hat{\rho}(t) &= &\frac{1}{i\hbar}\hat{H}\qty(\sum_i w_i \ket{\psi_i(t)}\bra{\psi_i(t)}) -\frac{1}{i\hbar}\qty(\sum_i w_i \ket{\psi_i(t)} \bra{\psi_i(t)})\hat{H}\nonumber\\ & = &\frac{1}{i\hbar}\hat{H}\hat{\rho} -\frac{1}{i\hbar}\hat{\rho}\hat{H}\nonumber\\& = & -\frac{1}{i\hbar}\qty[\hat{\rho},\hat{H}],
	\label{eq:27}
\end{eqnarray}
conhecida como equação de \textbf{Liouville-von Neumann}, que descreve a evolução temporal do operador densidade \cite{sakurai2013mecanica,RobertField}. Embora essa equação seja semelhante a equação de Heisenberg, exceto por um sinal negativo ($-$), é preciso lembrar que estamos trabalhando na formulação Schrödinger, visto que o operador densidade $\hat{\rho}$ é construído a partir de kets e bras que evoluem no tempo e obedecem a equação de Schrödinger.

\chapter{Interação sistema atômico de dois níveis com radiação}\label{cap:capitulo4}

Neste Capítulo aplicaremos a equação Liouville-Von-Newmann, que obtemos no Capítulo \ref{cap:capitulo2}, a um sistema de dois níveis que sofre pertubação de um campo elétrico. Essa interação é estudada aqui no ponto vista semiclássico , em que os átomos são tratados pela quântica e o campo é tratado classicamente. Para isso, primeiramente, obtemos uma aproximação semi-clássica para o hamiltoniano que  descreve essa interação.    

\section{Hamiltoniano para um sistema atômico de dois níveis }\label{sec:seção4.1}
Antes de obtermos o hamiltoniano para interação entre um campo e um átomo, vamos nos ater a um sistema clássico composto de uma partícula  carregada na presença de um campo eletromagnético (figura \ref{fig:particulaq}). Nesta condição, a força de Lorentz que atua na partícula com carga $q$ corresponde à:

\begin{equation}
\vb{F} = q\qty(\vb{E}+\vb{v}\cross\vb{B}),
\label{eq:4.1}
\end{equation}
\begin{figure}[H]
	\caption{Representação de uma partícula de carga $q$ na presença de um campo eletromagnético.}
	\centering
	\begin{tikzpicture}
		\path[draw,thick,-latex] (0,0)--(0,5) node[above]{$y$};
		\path[draw,thick, -latex] (0,0)--(5,0)node[right]{$x$};
		\foreach \i in {0.5,1.5,...,4.5}{
			\foreach \j in {0.5,1.5,...,4.5}{
				\node at (\i,\j){$\otimes$};
			}
		}
		\path[draw, -latex] (5,2.5)--node[right]{$E$}(5,3.5);
		\node at (2.5,5){$B\perp$};
		\draw[black, thick] (2,3) node{$q$} circle (0.2);
		\draw[black,-latex] (2,3.2) -- (2,4) node[above]{$F_e$} ;
		\draw[black,-latex] (2,2.8) -- (2,2) node[below]{$F_b$} ;
		\draw[black,-latex] (2.2,3) -- (3,3) node[right]{$v$};
	\end{tikzpicture}
	\label{fig:particulaq}
\end{figure}


Podemos reescrever o campo elétrico ($\vb{E}$) e magnético ($\vb{B}$) em termos do potencial escalar $\phi(\vb{r},t)$ e do potencial vetor $\vb{A}(\vb{r},t)$ :
\begin{eqnarray}
\vb{E} & = &-\pdv{\vb{A}}{t} - \grad{\phi}\label{eq:4.2}\\
\vb{B} & = &\curl{\vb{A}}\label{eq:4.3}.
\end{eqnarray} 
Assim, reescrevendo a força de Lorentz \eqref{eq:4.1} em termos destes potenciais, temos que
\begin{equation}
\vb{F} = q\qty[-\pdv{\vb{A}}{t} - \grad{\phi}+\vb{v}\cross(\curl{\vb{A}})].
\label{eq:4.4}
\end{equation}
Usando a identidade vetorial
\begin{equation}
\vb{v}\cross(\curl{\vb{A}}) = \grad(\vb{v}\vdot\vb{A}) - (\vb{v}\vdot\grad)\vb{A},
\label{eq:4.5}
\end{equation}
obtemos
\begin{equation}
\vb{F} = q\qty[-\pdv{\vb{A}}{t} - \grad{\phi}+\grad(\vb{v}\vdot\vb{A}) - (\vb{v}\vdot\grad)\vb{A}].
\label{eq:4.6}
\end{equation}
Partindo do fato que $\vb{A}$ varia no tempo e no espaço, temos que sua derivada total é 
\begin{eqnarray}
\dd\vb{A} & \equiv & \vb{A}(\vb{r}+\vb{v}\dd t, t+\dd t) - \vb{A}(\vb{r}, t)
\nonumber\\
& = & \qty(v_x\pdv{\vb{A}}{x} + v_y\pdv{\vb{A}}{y} + v_z\pdv{\vb{A}}{z} + \pdv{\vb{A}}{t})\dd t
\nonumber\\
& = & \qty[(\vb{v}\vdot\grad)\vb{A} +\pdv{\vb{A}}{t}]\dd t.
\label{eq:4.7}
\end{eqnarray}  
Logo,
\begin{equation}
\dv{\vb{A}}{t} = (\vb{v}\vdot\grad)\vb{A} +\pdv{\vb{A}}{t}.
\label{eq:4.8}
\end{equation}
Substituindo esse resultado na equação \eqref{eq:4.6}, temos:
\begin{equation}
\vb{F} = q\qty[-\dv{\vb{A}}{t} - \grad{\phi}+\grad(\vb{v}\vdot\vb{A})].
\label{eq:4.9}
\end{equation}
Assim, a equação de movimento para uma partícula carregada  se torna
\begin{equation}
m\dv{\vb{v}}{t} = q\qty[-\dv{\vb{A}}{t} - \grad{\phi}+\grad(\vb{v}\vdot\vb{A})].
\label{eq:4.10}
\end{equation}
ou
\begin{equation}
m\dv{t}[\vb{v} + q\vb{A}] = \grad{\qty[q(\vb{v}\vdot\vb{A}) -q\phi]}.
\label{eq:4.11}
\end{equation}
Examinando esta equação, podemos reescrevê-la na forma de uma equação de Euler-Lagrange
\begin{equation}
\dv{t}(\pdv{L}{\vb{v}}) = \grad L,
\label{eq:4.12}
\end{equation}
se adotarmos a lagrangiana
\begin{equation}
L = \frac{1}{2}m\vb{v}^2 + q(\vb{v}\vdot\vb{A}) - q\phi.
\label{eq:4.13}
\end{equation}
Como vamos trabalhar com um sistema atômico, é necessário adicionar a essa equação a energia potencial eletrostática $V(\vb{r})$, referente a interação do elétron com o núcleo atômico, e usar a carga do elétron $q=e$. Assim, obtemos 
\begin{equation}
L = \frac{1}{2}m\vb{v}^2 + e(\vb{v}\vdot\vb{A}) - e\phi - V(\vb{r}).
\label{eq:4.14}
\end{equation}

Aplicando a transformação de legendre apropriada a lagrangiana, usando a definição de momento conjugado $p_i \equiv \pdv{L}{\dot{q}_i} = m\dot{q}_i + eA_i$, obtemos o hamiltoniano de acoplamento mínimo \cite{scullyquantum,meystre2007elements}:
\begin{eqnarray}
H &=&  \sum_i p_i \dot{q}_i -L\nonumber\\&=& \vb{p}\cdot\frac{(\vb{p}-e\vb{A})}{m} -\frac{(\vb{p}-e\vb{A})^2}{2m} - e\qty[\frac{(\vb{p}-e\vb{A})}{m}\vdot\vb{A}] + e\phi + V(\vb{r}) \nonumber\\&=& \frac{1}{2m}(\vb{p}-e\vb{A})^2 + e\phi + V(\vb{r}).
\label{eq:4.15}
\end{eqnarray}
Esse hamiltoniano é invariante à transformação de calibre  
\begin{eqnarray}
\vb{A}' & = & A + \grad \gamma \label{eq:4.16}\\
\phi' & = & \phi - \pdv{\gamma}{t}, \label{eq:4.17}
\end{eqnarray}
onde $\gamma$ é a função de calibre.

Obtemos o análogo quântico do hamiltoniano fazendo a transformações
\begin{eqnarray}
	r &\longrightarrow& \hat{r} = r\\
	p &\longrightarrow& \hat{p} = -i\hbar\grad.
\end{eqnarray} 
Assim, podemos aplicá-lo a equação de Schrödinger dependente do tempo  
\begin{equation}
\hat{H}\ket{\psi}=i\hbar\pdv{t}\ket{\psi}.
\label{eq:4.18}
\end{equation}
Para resolvermos esta equação é ideal realizar uma transformação unitária $\hat{U}$ , considerando que $\ket{\psi} = \hat{U}\ket{\psi'}$. Essa transformação deve nos dar uma nova hamiltoniana escrita em termos de \eqref{eq:4.16} e \eqref{eq:4.17} da seguinte forma:
\begin{equation}
	\hat{H}' =  (\vb{p}-e\vb{A}')^2 + q\phi' + V(\vb{r}).
	\label{eq:4.20}
\end{equation}
Para isso, precisamos escolher transformação unitária $\hat{U} = e^{i\frac{e}{\hbar}\gamma}$ e assim garantimos que a física do problema não se altere, qualquer seja o valor de $\gamma$.

Supondo que os átomos estão imersos em uma onda plana monocromática, podemos escrever o potencial vetor da seguinte forma:
\begin{equation}
\vb{A}(\vb{r},t) =\frac{A_0(\omega)\hat{\epsilon}}{2} e^{i(\vb{k}\vdot\vb{r} - \omega t)} + c.c.
\label{eq:4.22}
\end{equation}
$\vb{k}\vdot\vb{r}  = 2\pi\vdot\frac{r}{\lambda}$, onde $\lambda$ é o comprimento de onda do campo. Em geral, o comprimento de onda é muito maior que as dimensões atômicas, $|\vb{r}|\simeq 10$ \AA. Assim, $\vb{k}\vdot\vb{r}\ll 1$. Com isso podemos  considerar apenas o primeiro termo da seguinte expansão em série de Taylor 
\begin{equation}
\vb{A}(\vb{r}, t) = \frac{A_0(\omega)\hat{\epsilon}}{2}e^{-i\omega t}\qty[1 + (i\vb{k}\vdot\vb{r}) + \frac{1}{2}(i\vb{k}\vdot\vb{r})^2 +\cdots] + c.c.,
\label{eq:4.23}
\end{equation}
de forma que $\vb{A}(\vb{r}, t) \simeq \vb{A}(t) = \frac{A_0(\omega)\hat{\epsilon}}{2}e^{-i\omega t} + c.c. $. Escolhendo a função de calibre como $\gamma = -\vb{A}(t)\vdot \vb{r}$, obtemos
\begin{equation}
\grad{\lambda} = -\vb{A}(t)
\label{eq:4.24}
\end{equation}
e
\begin{equation}
\pdv{\lambda}{t} = -\vb{r}\pdv{\vb{A}(t)}{t} = \vb{r}\vdot\vb{E}(t).
\label{eq:4.25}
\end{equation}
Fazendo $\phi = 0$ e realizando a escolha do calibre de Coulomb, onde $\div \vb{A} = 0$ e usando \eqref{eq:4.24} e \eqref{eq:4.25} em \eqref{eq:4.20},  obtemos
\begin{equation}
\hat{H}'=\frac{\vb{p}^2}{2m} + V(\vb{r}) - \vb{d}\vdot\vb{E},
\label{eq:4.26}
\end{equation}
em que  $\vb{d}=e\vb{r}$ é o momento de dipolo elétrico. Os dois primeiro termos se referem ao átomo não perturbado ($H_0 =\vb{p}^2/2m + V(\vb{r})$) e o último termo é referente a interação com o campo elétrico na aproximação de dipolo $(H_{int} = -\vb{d}\vdot\vb{E})$ \cite{scullyquantum,meystre2007elements}. Essa equação representa a energia de um dipolo elétrico inserido num campo elétrico $\vb{E}$. Para isso, consideramos que um único elétron é o responsável pelo surgimento do  momento de dipolo elétrico.
 Esta aproximação  será utilizada no decorrer deste TCC.

\section{Sistema atômico de dois níveis}\label{sec:2niveis}

Neste TCC, trabalharemos com um sistema de dois níveis, sistema quântico simples que é descrito em duas dimensões no espaço de Hibert. Com esse sistema, poderemos estudar de maneira simples e detalhada as principais propriedades físicas inerentes ao processo de iteração de radiação com a matéria. Isso é possível, pois, apesar de sua simplicidade, existem diversos fenômenos quânticos que são descritos de forma satisfatória. Alguns exemplos  são problemas que envolvem polarização de fótons, spin do elétron, oscilações dos neutrinos e o caso deste TCC, um sistema atômico que possui dois níveis em ressonância (ou próximo da ressonância) com o campo eletromagnético aplicado e onde os demais níveis estão em dessintonia total com esse campo \cite{allen1987optical}.

O sistema de dois níveis sem pertubação possui dois valores prováveis de energia. O estado $\ket{1} $ com energia $E_1 = \hbar \omega_1$ e o estado $\ket{2}$ com energia $E_2 = \hbar \omega_2$, como representado na figura \ref{fig:1}. De acordo com descrição de Bohr, a transição entre os níveis atômicos $\ket{1}$ e $\ket{2}$ é dada pela frequência 
\begin{eqnarray}
\omega_{21} & = & \omega_2 - \omega_1\label{eq:4.28}\\
& = & (E_2-E_1)/\hbar \label{eq:4.29}.
\end{eqnarray}
Então, o hamiltoniano do átomo livre, na aproximação de dois níveis, é dado por  
\begin{equation}
	\hat{H_0} = \hbar \omega _1\dyad{1}{1} +\hbar \omega _2\dyad{2}{2}.
	\label{eq:4.33}
\end{equation}
\begin{figure}[H]
	\caption{Níveis de energia de um hipotético átomo de dois níveis. A dessintonia $\delta = \omega_{ab} - \omega$ é a diferença entre $(E_2-E_1)/\hbar$ e $\omega_c$, onde $\omega_c$ é a frequência angular da radiação eletromagnética do laser incidente.} 
	\centering 
	\begin{tikzpicture}
		\draw [thick](0,0) -- (3,0) node[pos=1.1]{$E_1$} (0,5) -- (3,5) node[pos=1.1]{$E_2$};
		\draw [thick, blue,<->] (0.5,3.95) -- (0.5,0.05) node[pos=0.5,right=1pt,black]{$\omega_c$};
		\draw [thick,blue,<->] (2.5,0.05) -- (2.5,4.95) node[pos=0.5,right=1pt,black]{$\omega_{21}$};
		\draw [thick,blue,<->] (0.5,4.05) -- (0.5,4.95) node[pos=0.5,right=1pt,black]{$\delta$};
		\draw [thick,red, dashed] (0.23,4) -- (0.83,4);
	\end{tikzpicture}
	\label{fig:1}
\end{figure}

A função de onda para o sistema de dois níveis é 
\begin{equation}
\ket{\psi(t)} = c_1(t)\ket{1} + c_2(t)\ket{2},
\label{eq:4.30}
\end{equation}
onde $c_1$ e $c_2$ são as amplitudes de probabilidade de encontrar o átomo nos estados $\ket{1}$ e $\ket{2}$, respectivamente. Apesar de ser possível obter as equações de movimento para nosso sistema utilizando a representação de Schrödinger, é mais conveniente utilizarmos o formalismo de matriz densidade, que apresentamos no Capítulo \ref{cap:capitulo2}. Isso é necessário, pois estamos trabalhando com um grande número de átomos interagindo com o campo. Neste caso, o cálculo das amplitudes de probabilidade seria muito complexo, pois teríamos que calcular esta amplitude para cada átomo do nosso sistema. Em contrapartida, no formalismo de matriz densidade não precisamos ter a informação completa do vetor  onda, pois nos importamos apenas com as informações estatísticas do operador densidade. Assim, diminuímos o custo computacional para lidar com um número grande de átomos interagindo com o campo.

A matriz densidade para um sistema de dois níveis descrito pela equação \eqref{eq:4.30} é dada por:
\begin{eqnarray}
	\hat{\rho}(t)&=& \sum_{i} w_i \dyad{\psi_i(t)}{\psi_i(t)} \\
	&=& \sum_{i} w_i \mqty(\qty|c_1^i|^2 & c_1^ic_2^{i*} \\ c_2^ic_1^{i*} & \qty|c_1^i|^2)\\
	&=& \mqty(\overline{\qty|c_1|^2} & \overline{c_1c_2^*} \\ \overline{c_2c_1^*} & \overline{\qty|c_1|^2})\\&=& \mqty(\rho_{11} & \rho_{12} \\ \rho_{21} & \rho_{22}).
	\label{eq:4.31}
\end{eqnarray}
Os elementos da diagonal principal correspondem às probabilidades de encontrar as populações atômicas no estado fundamental ($\ket{1}$) ou no estado excitado ($\ket{2}$). Os elementos fora da diagonal principal correspondem à coerência entre os estados $\ket{1}$ e $\ket{2}$. Assim, os elementos $\rho_{nm}$ da matriz densidade se relacionam com as amplitudes de probabilidade da seguinte forma:
\begin{equation}
	\rho_{nm} = \sum_i w_i c_n^ic_m^{i*},
	\label{eq:4.32}
\end{equation}

Vimos na Seção \ref{sec:seção4.1} que A energia de interação na aproximação dipolar é 
\begin{equation}
	H_{int}  = - \vb{d}\vdot\vb{E}.
	\label{eq:4.27}
\end{equation}
Um campo eletromagnético externo clássico, com frequência $\omega_c$, é dado por
\begin{equation}
	 \vb{E}(t) =  \frac{1}{2}\vb{\mathcal{E}}(t)e^{iw_ct} + c.c.
	\label{eq:4.34}
\end{equation}
O átomo não possui momento de dipolo quanto está em um de seus estados estacionários, então $\mel{1}{\hat{d}}{1}=\mel{2}{\hat{d}}{2}=0$. Assim, para um sitema de dois níveis,podemos escrever o operador momento de dipolo como
\begin{equation}
	\hat{d}  =  d_{12}\dyad{1}{2} + d_{21}\dyad{2}{1}.
	\label{eq:4.35}
\end{equation} 
A partir das equações \eqref{eq:4.34} e \eqref{eq:4.35} e levando em conta que o momento de dipolo tem a mesma direção do campo, podemos reescrever o hamiltoniano da interação na aproximação de dipolo \eqref{eq:4.27} da seguinte forma:
\begin{equation}
	\hat{H}_{int}  =  -(\frac{1}{2}\mathcal{E}e^{iw_ct}+\frac{1}{2}\mathcal{E}^*e^{-iw_ct})d_{12}\dyad{1}{2} - (\frac{1}{2}\mathcal{E}e^{iw_ct}+\frac{1}{2}\mathcal{E}^*e^{-iw_ct})d_{21}\dyad{2}{1}.
	\label{eq:4.36}
\end{equation}

Agora vamos nos aproveitar do fato que o sistema atômico de dois níveis está próximo à ressonância com o campo eletromagnético para realizar uma aproximação no hamiltoniano. Primeiramente, vamos fazer uma transformação unitária ao hamiltoniano \eqref{eq:4.36} para sairmos da representação de Schrödinger para a representação de Dirac. Para isso, usamos o operador de transformação unitária e a relação de completeza,  
\begin{equation}
	\hat{U}  =  e^{i\frac{\hat{H_0}}{\hbar}t} =  e^{i\omega_{1}t}\dyad{1}{1} + e^{i\omega_{2}t}\dyad{2}{2},
	\label{eq:4.37}
\end{equation}
e, assim, obtemos o seguinte hamiltoniano:
\begin{eqnarray}
	\hat{H}_{D,int} &  =  & 	\hat{U}\hat{H}_{int}\hat{U}^\dagger\nonumber\\
				  &  =  & 	\mqty( e^{i\omega_{1}t} & 0 \\ 0 & e^{i\omega_{2}t}) \mqty(0 & -d_{12}E\nonumber\\ -d_{21}E & 0) \mqty( e^{-i\omega_{1}t} & 0 \\ 0 & e^{-i\omega_{2}t})\nonumber\\
				   &  =  & (\mathcal{E}e^{iw_ct}+\mathcal{E}^*e^{-iw_ct})\frac{d_{12}}{2}e^{-i\omega_{21}t}\dyad{1}{2}\nonumber\\& +& (\mathcal{E}e^{iw_ct}+\mathcal{E}^*e^{-iw_ct})\frac{d_{21}}{2}e^{i\omega_{21}t}\dyad{2}{1}\nonumber\\
				   &  =  & (\mathcal{E}e^{i\delta t}+\mathcal{E}^*e^{-i(w_c+\omega_{21})t})\frac{d_{12}}{2}\dyad{1}{2}\nonumber\\& +& (\mathcal{E}e^{i(\omega_c +\omega_{21}) t}+\mathcal{E}^*e^{-i\delta t})\frac{d_{21}}{2}\dyad{2}{1},
	\label{eq:4.38}
\end{eqnarray}
onde $\delta = \omega_c - \omega_{21}$ é a dessintonia entre o campo e o átomo. Como o campo está próximo da ressonância com átomo, $\delta \ll \omega_c + \omega_{21}$. Isso significa que os termos que oscilam com frequência ($\omega_c + \omega_{21}$) alteram rapidamente em relação ao termos que oscilam com frequência $\delta$, por isso podemos ignorar esse termos, utilizando  a aproximação de onda girante (RWA - Rotating Wave Approximation) \cite{scullyquantum}. Nestas condições, a equação do hamiltoniano \eqref{eq:4.38} se reduz em
\begin{equation}
		\hat{H}_{D,int} = \frac{d_{12}}{2}\mathcal{E}e^{i\delta t}\dyad{1}{2} + \frac{d_{21}}{2}\mathcal{E}^*e^{-i\delta t}\dyad{2}{1},
	\label{eq:4.39}
\end{equation}
Finalmente, podemos retornar o hamiltoniano à representação de Schrödinger:
\begin{eqnarray}
	\hat{H}_{int} &  =  & 	\hat{U}^\dagger\hat{H}_{D,int}\hat{U}\nonumber\\
	&  =  & 	\mqty( e^{-i\omega_{1}t} & 0 \\ 0 & e^{-i\omega_{2}t}) \mqty(0 & \frac{d_{12}}{2}\mathcal{E}e^{i\delta t} \nonumber\\ \frac{d_{21}}{2}\mathcal{E}^*e^{-i\delta t}  & 0) \mqty( e^{i\omega_{1}t} & 0 \\ 0 & e^{i\omega_{2}t})\nonumber\\
	&  =  & \frac{d_{12}}{2}\mathcal{E}e^{i\delta t}e^{i\omega_{21}t}\dyad{1}{2} + \frac{d_{21}}{2}\mathcal{E}^*e^{-i\delta t}e^{-i\omega_{21}t}\dyad{2}{1}\nonumber\\
	&  =  & \frac{d_{12}}{2}\mathcal{E}e^{i\omega_c t}\dyad{1}{2} + \frac{d_{21}}{2}\mathcal{E}^*e^{-i\omega_c t}\dyad{2}{1}.
	\label{eq:4.40}
\end{eqnarray}
Com isso, a expressão para o Hamiltoniano total  do sistema de dois níveis com pertubação de campo eletromagnético é dada por:
\begin{equation}
	\hat{H} = \hbar \omega _1\dyad{1}{1} +\hbar \omega _2\dyad{2}{2} - \frac{d_{12}}{2}\mathcal{E}e^{i\omega_c t}\dyad{1}{2} - \frac{d_{21}}{2}\mathcal{E}^*e^{-i\omega_c t}\dyad{2}{1}
	\label{eq:4.41}
\end{equation}

No capítulo \ref{cap:capitulo2} obtemos a equação de J. von-Newman \eqref{eq:27}, que descreve a evolução temporal da matriz densidade. Vamos utilizar essa equação para descrevermos a evolução temporal para o sistema interagente, mas precisaremos inserir de forma fenomenológica o termo de decaimento referente a emissão espontânea ou ocasionados por colisões entre átomos \cite{boyd2008nonlinear}. Assim, equação \eqref{eq:27} para o elemento da matriz densidade se torna
\begin{eqnarray}
	\dv{{\rho}'_{nm}}{t} &=& \frac{i}{\hbar}\qty[\hat{\rho}', \hat{H}]_{nm} - \gamma_{nm}\rho'_{nm} \textnormal{ para } n\neq m	\label{eq:4.44}\\
	\dv{{\rho}'_{nn}}{t} &=& \frac{i}{\hbar}\qty[\hat{\rho}', \hat{H}]_{nn} + \sum_{E_m>E_n}\Gamma_{nm}\rho'_{mm} - \sum_{E_m<E_n}\Gamma_{mn}\rho'_{nn}.
	\label{eq:4.45}	
\end{eqnarray}
Aqui, $\gamma_{nm}$ é a taxa de relaxamento da coerência $\rho_{nm}$, onde $\gamma_{nm} = \gamma_{mn}$. O termo $\Gamma_{nm}$ é a taxa de decaimento do estado $\ket{m}$ para um estado $\ket{n}$. O tempo de vida de um estado $\ket{n}$ é $T_n=1/\Gamma_{n}$, onde $\Gamma_{n}$ é a taxa de decaimento total dada pela soma de todas a taxa de decaimento do estado $\ket{n}$ para estados de menor energia, ou seja,
\begin{equation}
	\Gamma_{n}=\sum_{E_n'<E_n}\Gamma_{n'n}.
	\label{eq:4.46}	
\end{equation}

\begin{sagesilent}
	cn(t) = exp(-t)
\end{sagesilent}

\begin{figure}[H]
	\caption{Amplitude de probabilidade $c_n(t)$ decai conforme \eqref{eq:4.48}.}
	\centering
	\sageplot[scale=0.7]{plot(cn(t),t,0,5),frame=true,figsize = (4,4),axes=false, axes_labels=("$t/\Gamma_n$", "$C_n^{i}(t)/c_n^{i}(t)$")}
	\label{fig:delay}
\end{figure}
Agora, a probabilidade de encontrar um átomo no estado $\ket{n}$ (exceto o estado fundamental) diminui ao longo do tempo da seguinte forma:
\begin{equation}
	\qty|C_n^{i}(t)|^2 = \qty|c_n^{i}(t)|^2 e^{-\Gamma_n t}.
	\label{eq:4.47}	
\end{equation}
Isso significa que a nova amplitude de probabilidade obedece a relação  
\begin{equation}
	C_n^i(t) =c_n^i(t)e^{-\frac{\Gamma_n }{2}t},
	\label{eq:4.48}	
\end{equation}
conforme vemos na figura \ref{fig:delay}. Com isso, temos que $C_n^i(t)C^{i*}_m(t)$ é escrita como
\begin{equation}
	C_n^i(t)C^{i*}_m(t) =c_n^i(t)c_m^{i*}(t)e^{-(\Gamma_n + \Gamma_m)\frac{t}{2}}.
	\label{eq:4.50}		
\end{equation}
Da mesma maneira que \eqref{eq:4.32}, podemos espressar o novo $\rho'_{mn}$ em termos de $C_n^i(t)C^{i*}_m(t)$. Assim, obtemos
\begin{eqnarray}
	\rho'_{mn} &=& \rho_{mn}e^{-(\Gamma_n + \Gamma_m)\frac{t}{2}}\text{~se~}n\neq m\\
	\rho'_{nn} &=& \rho_{nn}e^{-\Gamma_nt}
\end{eqnarray}

Sabemos que a taxa de relaxação de $\rho_{mn}$ (trabalharemos com o novo operador densidade ignorando  ($'$) a partir daqui) é $\gamma_{mn}$. Assim, obtemos uma relação entre as taxas de decaimento dos elementos fora da diagonal principal com os elementos da diagonal principal, dada por
\begin{equation}
	\gamma_{mn} =\frac{1}{2}(\Gamma_n + \Gamma_m) + \gamma_{mn}^{(c)}.
	\label{eq:4.51}
\end{equation}
onde adicionamos o termo $\gamma_{mn}^{(c)}$ que se refere a taxa de defasagem de dipolo, em consequência de colisões entre átomos. 

Para calcularmos os elementos $\rho_{nm}$ da matriz densidade com $n\neq m$, para sistema de dois níveis, partimos da equação \eqref{eq:4.45}. Assim, podemos calcular  $\dot{\rho}_{12}$:
\begin{eqnarray}
	\pdv{t}\mel{1}{\hat{\rho}}{2} & = &  \frac{i}{\hbar}\mel{1}{\qty[\hat{\rho},\hat{H}]}{2} - \gamma_{12}\rho_{12}\nonumber\\
	 							  & = &  \frac{i}{\hbar}\mel{1}{\hat{\rho}\hat{H} - \hat{H}\hat{\rho} }{2} - \gamma_{12}\rho_{12}\nonumber\\
	 							  & = &  \frac{i}{\hbar}(\mel{1}{\hat{\rho}\hat{H}}{2} - \mel{1}{\hat{H}\hat{\rho} }{2})- \gamma_{12}\rho_{12}\nonumber\\
	 							  & = &  \frac{i}{\hbar}(\hbar \omega_{2}\rho_{12} -  \frac{d_{12}}{2}E_0e^{i\omega_c t} \rho_{11}-\hbar \omega_{1} \rho_{12} +  \frac{d_{12}}{2}E_0e^{i\omega_c t} \rho_{22}) - \gamma_{12}\rho_{12}\nonumber\\
	 							  & = &  (i \omega_{21} - \gamma_{12})\rho_{12} +  i\frac{d_{12}}{2\hbar}E_0e^{i\omega_c t}(\rho_{22}-\rho_{11}) 
\end{eqnarray}
e  $\dot{\rho}_{21}$ 
\begin{eqnarray}
	\pdv{t}\mel{2}{\hat{\rho}}{1} & = &  \frac{i}{\hbar}\mel{2}{\qty[\hat{\rho},\hat{H}]}{1} - \Gamma_{12}\rho_{21}\nonumber\\
	& = &  \frac{i}{\hbar}\mel{2}{\hat{\rho}\hat{H} - \hat{H}\hat{\rho} }{1} - \Gamma_{12}\rho_{21}\nonumber\\
	& = &  \frac{i}{\hbar}(\mel{2}{\hat{\rho}\hat{H}}{1} - \mel{2}{\hat{H}\hat{\rho} }{1})- \Gamma_{12}\rho_{21}\nonumber\\
	& = &  \frac{i}{\hbar}(\hbar \omega_{1}\rho_{21} -  \frac{d_{21}}{2}E_0^*e^{-i\omega_c t} \rho_{22}-\hbar \omega_{2} \rho_{21} +  \frac{d_{21}}{2}E_0^*e^{-i\omega_c t} \rho_{11}) - \Gamma_{12}\rho_{21}\nonumber\\
	& = &  -(i \omega_{21} + \Gamma_{12})\rho_{21} -  i\frac{d_{21}}{2\hbar}E_0^*e^{-i\omega_c t}(\rho_{22}-\rho_{11}). 
\end{eqnarray}
O cálculo para os elementos da diagonal principal da matriz densidade são obtidos pela equação \eqref{eq:4.46}. Assim, $\dot{\rho}_{11}$ é dado por 
\begin{eqnarray}
	\pdv{t}\mel{1}{\hat{\rho}}{1} & = &  \frac{i}{\hbar}\mel{1}{\qty[\hat{\rho},\hat{H}]}{1} + \Gamma_{12}\rho_{22}\nonumber\\
	& = &  \frac{i}{\hbar}\mel{1}{\hat{\rho}\hat{H} - \hat{H}\hat{\rho} }{1} + \Gamma_{12}\rho_{22}\nonumber\\
	& = &  \frac{i}{\hbar}(\mel{1}{\hat{\rho}\hat{H}}{1} - \mel{1}{\hat{H}\hat{\rho} }{1})+ \Gamma_{12}\rho_{22}\nonumber\\
	& = &  \frac{i}{\hbar}(\hbar \omega_{1}\rho_{11} -  \frac{d_{21}}{2}E_0^*e^{-i\omega_c t} \rho_{12}-\hbar \omega_{1} \rho_{11} +  \frac{d_{12}}{2}E_0e^{i\omega_c t} \rho_{21}) + \Gamma_{12}\rho_{22}\nonumber\\
	& = &  \frac{d_{12}}{2\hbar}E_0e^{i\omega_c t} \rho_{21} - \frac{d_{21}}{2}E_0^*e^{-i\omega_c t} \rho_{12} + \Gamma_{12}\rho_{22}
\end{eqnarray}
e $\dot{\rho}_{22}$ 
\begin{eqnarray}
	\pdv{t}\mel{2}{\hat{\rho}}{2} & = &  \frac{i}{\hbar}\mel{2}{\qty[\hat{\rho},\hat{H}]}{2} - \Gamma_{12}\rho_{22}\nonumber\\
	& = &  \frac{i}{\hbar}\mel{2}{\hat{\rho}\hat{H} - \hat{H}\hat{\rho} }{2} - \Gamma_{12}\rho_{22}\nonumber\\
	& = &  \frac{i}{\hbar}(\mel{2}{\hat{\rho}\hat{H}}{2} - \mel{2}{\hat{H}\hat{\rho} }{2})- \Gamma_{12}\rho_{22}\nonumber\\
	& = &  \frac{i}{\hbar}(\hbar \omega_{2}\rho_{22} -  \frac{d_{12}}{2}E_0e^{i\omega_c t} \rho_{21}-\hbar \omega_{2} \rho_{22} +  \frac{d_{21}}{2}E_0^*e^{-i\omega_c t} \rho_{12}) - \Gamma_{12}\rho_{22}\nonumber\\
	& = &  -\frac{d_{12}}{2\hbar}E_0e^{i\omega_c t} \rho_{21} + \frac{d_{21}}{2}E_0^*e^{-i\omega_c t} \rho_{12} - \Gamma_{12}\rho_{22}
\end{eqnarray}

Para simplificarmos essas equações, devemos considerar o fato que  $\rho_{11}+\rho_{22}=1$ , $\rho_{12}=\rho_{21}^*$, $d_{12} = d_{21}$ e definirmos a frequência de Rabi como
\begin{equation}
	\Omega_0 \equiv \frac{d_{12}}{\hbar}E_0.
	\label{eq:4.56}
\end{equation}
Assim, obtemos
\begin{eqnarray}
	\dot{\rho}_{12} & = &  (i \omega_{21} - \gamma_{12})\rho_{12} -  i\frac{\Omega_0}{2}e^{i\omega_c t}(1 - 2\rho_{22})\\
	\dot{\rho}_{22} & = &  -i\frac{\Omega_0}{2}e^{i\omega_c t} \rho_{12}^* + i\frac{\Omega_0^*}{2}e^{-i\omega_c t} \rho_{12} - \Gamma_{12}\rho_{22}
\end{eqnarray}
Podemos reescrever as equações acima, realizando as seguintes mudanças de variáveis
\begin{eqnarray}
\rho_{12} & \equiv &  \sigma_{12}e^{i\omega_c t}\\
\rho_{22} & \equiv &  \sigma_{22}.
\end{eqnarray}
Assim, obtemos
\begin{eqnarray}
	\dot{\sigma}_{12} & = &  (i \delta - \gamma_{12})\sigma_{12} -  i\frac{\Omega_0}{2}(1 - 2\sigma_{22})\label{eq:4.61}\\
	\dot{\sigma}_{22} & = &  -i\frac{\Omega_0}{2}\sigma_{12}^* + i\frac{\Omega_0^*}{2} \sigma_{12} - \Gamma_{12}\sigma_{22}\label{eq:4.62},
\end{eqnarray}
que são conhecidas na literatura como equações  ópticas de bloch~\cite{foot2005atomic}.
\subsection{O átomo de Rubídio ($^{87}Rb$) e sua transição ($5^2S_{1/2}\longrightarrow5^2P_{1/2}$) }

Para estudarmos as interações entre o campo eletromagnético com sistemas de dois níveis, vamos utilizar parâmetros da transição $5^2S_{1/2}\longrightarrow5^2P_{1/2}$ do isótopo Rubídio-$87$, que é um isótopo natural do elemento químico Rubídio~(Rb) (compõe aproximadamente $27,83$ do rubídio encontrado na natureza) que faz parte do metais alcalinos, representados no grupo 1 da tabela periódica.
\begin{figure}[H]
	\centering
	\caption{Amostra de Rubídio.}
	\label{fig:rubidio}
	\includegraphics[width=0.5\linewidth]{figuras_do_trabalho/Rubidio}
	\caption*{Fonte: <\url{https://upload.wikimedia.org/wikipedia/commons/thumb/d/d2/RbH.JPG/1280px-RbH.JPG}>}
\end{figure}
O Rubídio-$87$ possui número atômico $37$ e sua massa atômica é de aproximadamente $86,9091852~u$ (Unidade de massa atômica). Esse isótopo é radiativo e tem tempo de meia-vida de aproximadamente $4,88\cdot10^{10}$ anos. Quando decai da origem ao Estrôncio-$87$, ejetando uma partícula $\beta^-$ (1 elétron do núcleo). Em temperatura ambiente ele pode ser encontrado no estado liquido, como vemos na amostra apresentada na figura \ref{fig:rubidio}.

A configuração eletrônica do rúbido é $1s^2$, $2s^2$, $2p^6$, $3s^2$, $3p^6$, $3d^{10}$, $4s^2$, $4p^6$ e $5s^1$. Assim, podemos trabalhar com esse átomo como se fosse um átomo de apenas um elétron. Vemos no curso de mecânica quântica que ao fazermos correções relativísticas ao Hamiltoniano  que advêm do acoplamento Spin-orbita $\hat{H}$, ocorre o aparecimento dos efeitos estruturas finas. Desta forma, obtemos o diagrama de níveis para o Rubídio, apresentado  na figura \ref{fig:rbenergy}.
\begin{figure}[H]
	\centering
	\caption{Diagrama de níveis e Transições do Rubídio.}
	\label{fig:rbenergy}
	\adjincludegraphics[trim={0 {.05\width} 0 {.08\width}},clip, width=0.8\linewidth]{figuras_do_trabalho/Rb_energy.pdf}
	\caption*{Fonte: <\url{http://raptor.physics.wisc.edu/data/Rb_energy.pdf}> }
\end{figure}

A determinação de estrutura fina se da pela definição de um momento Angular total $\hat{J}$ que é dado pela soma do momento angular orbital $\hat{L}$  e o spin $\hat{S}$
\begin{equation}
	\hat{J} = \hat{L} + \hat{S}
\end{equation}
Assim, no estado $5^2S_{1/2}$, em que $L = 0$ e $S = 1/2$, temos $J=1/2$. Para o estado $5^2P_{1/2}$, em que $L = 1$ e $S = -1/2$, temos $J=1/2$. O estado $5^2P_{1/2}$ é dado por $L = 1$ e $S = -1/2$, Logo $J=1/2$. 

A taxa de decaimento $\Gamma$ de uma transição $J\longrightarrow J'$, conforme vemos em steck~\cite{steck2001rubidium}, é dada por:
\begin{equation}
	\Gamma = \frac{e^2\omega_0^2}{\pi\epsilon_0m_ec^3}\frac{2J+1}{2J'+1}\qty|\bra{J}e\hat{r}\ket{J'}|^2
\end{equation}
onde $m_e$ e $e$ são massa e a carga do elétron, respectivamente. O termo $\qty|\bra{J}e\hat{r}\ket{J'}|^2$ é o momento de dipolo. Para a transição 
$5^2S_{1/2}\longrightarrow5^2P_{1/2}$, que utilizaremos neste TCC, temos esses valores valores tabelados e estão apresentados na tabela~\ref{tab:rubidio97} a seguir:

\begin{table}[H]
	\caption{Propriedades ópticas para transição $D1(5^2S_{1/2}\longrightarrow 5^2P_{1/2})$ do $^{87}Rb$}
	\centering
	\begin{tabular}{l|l|l}
		\hline
		Frequência & $\omega_{21}$ & $2\pi\cdot377,107 463 5$ THz \\
		\hline
		Tempo de vida & $T$ & $27,70$ ns \\
		\hline
		Taxa de decaimento & $\Gamma_{12}$ & $2\pi\cdot5,746$ MHz \\
		\hline
		momento de dipolo da transição $5^2S_{1/2}\longrightarrow 5^2P_{1/2}$ & $d_{12}$ & $2,537\times10^{-29}$Cm  \\
		\hline
	\end{tabular}
	\caption*{Fonte: Valores tabelados em~\cite{steck2001rubidium}.}
	\label{tab:rubidio97}
\end{table}
%\begin{figure}[H]
%	\centering
%	\begin{tikzpicture}
%		\draw[thick,->] (-0.5,-0.5) -- (11,-0.5);
%		\draw[thick,->] (-0.5,-0.5) -- (-0.5,7)node[above]{Energia};
%		\draw[thick] (0,0) -- (2,0)node[right]{$5^2S_{1/2}$};
%		\draw[thick] (0,4) -- (2,4)node[right]{$6^2S_{1/2}$};
%		\draw[thick] (4,2.5) -- (6,2.5)node[right]{$5^2P_{1/2}$};
%		\draw[thick] (4,3) -- (6,3)node[right]{$5^2P_{3/2}$};
%		\draw[thick] (4,5.5) -- (6,5.5)node[right]{$6^2P_{1/2}$};
%		\draw[thick] (4,5.9) -- (6,5.9)node[right]{$6^2P_{3/2}$};
%		\draw[thick] (8,3.5) -- (10,3.5)node[right, yshift=-3]{$4^2D_{3/2}$};
%		\draw[thick] (8,3.7) -- (10,3.7)node[right, yshift=3]{$4^2D_{5/2}$};
%		\draw[thick] (8,6.5) -- (10,6.5)node[right, yshift=-3]{$5^2D_{3/2}$};
%		\draw[thick] (8,6.8) -- (10,6.8)node[right, yshift=3]{$5^2D_{5/2}$};
%		\node at(1,-1){$(S)$}; \node at(5,-1){$(P)$}; \node at(9,-1){$(D)$};
%	\end{tikzpicture}
%\end{figure}
\section{Solução numérica das equações ópticas de bloch para campos contínuos}

Para estudarmos um campo contínuo, vamos utilizar uma interação produzida por um laser CW em átomos de Rubídio 87, onde estamos interessados em estudar a transição do estado fundamental $5^2 S_{1/2}$ para o estado excitado $5^2 P_{1/2}$. 

O laser CW é identificado usualmente pela sua potência. Podemos calcular a potência de um laser a partir da frequência de rabi $\Omega_0$, utilizando a seguinte relação \cite{griffiths2011elet}:
\begin{sagesilent}
	c=3e8
	omega=2*pi*5.746e6/4
	e0=8.8541878176e-12
	h = 1.05457168e-34
	d12 = 2.537e-29
	R = 1e-3
	A= pi*R^2
	P = (c*e0/2.0)*A*(h*omega/d12)^2
\end{sagesilent}
\begin{equation}
	\frac{P}{A} = I = \frac{c\epsilon_0}{2}\qty(\frac{\hbar}{d_{12}})^2\qty(\Omega_0)^2,
	\label{eq:4.77}
\end{equation}
onde $P$ é a potência irradiada, $A$ é a área de seção transversal do feixe e I é a intensidade de radiação. Para o caso em que estamos interessados, vamos utilizar uma  área $A$ circular $\pi R^2$, com o raio $R = 1$ mm e, também, vamos adotar uma frequência de rabi $\Omega_0=\gamma_{12}/2$. Atribuindo na equação  \eqref{eq:4.77} os valores de momento de dipolo transição $d_{12}$ e a taxa de decaimento $\gamma_{12}$ apresentados na tabela \ref{tab:rubidio97}, obtemos uma potência de $P=\sage{N(P/1e-6)}~\upmu$W para nosso laser.


\subsection{Metodologia}
\label{sec:metodo1}
As equação de bloch ópticas \eqref{eq:4.61} e \eqref{eq:4.62} possuem solução exata quando consideramos um campo contínuo. Essas soluções são obtidas a partir de métodos perturbativos, como vemos em \cite{allen1987optical}. Apesar disso, preferimos resolver essa equações numericamente, utilizando o método de runge-kutta de quarta ordem, muito popular na literatura 
\begin{equation}
	\dv{y}{x}= f(x,y),
\end{equation}
o algoritmo de Runge-Kutta de quarta ordem  calcula valores $y(x+h)$  a partir da expressão:
\begin{equation}
	y(x+h)= y(x)+\frac{1}{6}(k_1+k_2+k_3+k_4).
\end{equation}
Os valores de $k_1$, $k_2$, $k_3$ e $k_4$ são obtidos da seguinte forma: 
\begin{eqnarray}
	k_1&=&hf(x,y),\\
	k_2&=&hf(x+\frac{h}{2},y+\frac{k_1}{2} ),\\
	k_3&=&hf(x+\frac{h}{2},y+\frac{k_2}{2}),\\
	k_4&=&hf(x+h,y+k_3).
\end{eqnarray}
Como vamos trabalhar com um sistema de duas equações de primeira ordem do tipo
\begin{eqnarray}
		\dv{y}{x}&=& f(x,y,z)\\
		\dv{z}{x}&=& g(x,y,z),
\end{eqnarray}
precisamos adaptar o algoritmo de Runge-Kutta. Assim, o cálculo de $y(x+h)$ e $y(x+h)$ precisam obedecer as seguintes expressões: 
\begin{eqnarray}
	y(x+h)&=& y(x)+\frac{1}{6}(k_{y1}+k_{y2}+k_{y3}+k_{y4})\\
	z(x+h)&=& z(x)+\frac{1}{6}(k_{z1}+k_{z2}+k_{z3}+k_{z4})),
\end{eqnarray}
O parâmetros presentes no incremento dessas expressões são dados por:
\begin{eqnarray}
	k_{y1}&=&hf(x,y,z), k_{z1}=hg(x,y,z)\\
	k_{y2}&=&hf(x+\frac{h}{2},y+\frac{k_{y1}}{2},z+\frac{k_{z1}}{2}),k_{z2}=hg(x+\frac{h}{2},y+\frac{k_{y1}}{2},z+\frac{k_{z1}}{2} )\\
	k_{y3}&=&hf(x+\frac{h}{2},y+\frac{k_{y2}}{2},z+\frac{k_{z2}}{2}),k_{z3}=hg(x+\frac{h}{2},y+\frac{k_{y2}}{2},z+\frac{k_{z2}}{2})\\
	k_{y4}&=&hf(x+h,y+k_{y3},z+k_{z3}),k_{z4}=hg(x+h,y+k_{y3},z+k_{z3}).
\end{eqnarray}

O algoritmo de Runge-Kutta foi implementado em linguagem C. No algoritmo declaramos as bibliotecas  e os parâmetros globais da interação:
\begin{lstlisting}
//Bibliotecas
#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <complex.h>

//Parâmetros da interação------------------------------------
double 
	delta = 5*2*M_PI*5.746e6/2.0, // (Hz) ---> dessitonia entre o meio e o campo
	gama_populacao_12 = 2*M_PI*5.746e6,//(Hz) ---> taxa de decaimento
	gamma_coerencia_12= 2*M_PI*5.746e6/2.0,//(Hz) ---> taxa de rexação da coerência
	omega_0 = 2*M_PI*5.746e6/4.0;//(Hz) ---> frequência de rabi do campo cw
\end{lstlisting}
Em seguida, temos as funções que traz o método de Runge-kutta, que calcula $\sigma_{12}(t+dt)$ e $\sigma_{22}(t+dt)$
\begin{lstlisting}
//Método de Runge-kutta
void rk4(double complex(*f)(double, double complex, double complex), double complex(*g)(double, double complex, double complex), double dt, double *t, double complex *sigma_12, double complex *sigma_22)
{
	double complex	
		k1s12 = dt * f(*t, *sigma_12, *sigma_22), 
		k1s22 = dt * g(*t, *sigma_12, *sigma_22),
		
		k2s12 = dt * f(*t+dt/2.0, *sigma_12 + k1s12/2.0, *sigma_22 + k1s22/2.0),
		k2s22 = dt * g(*t+dt/2.0, *sigma_12 + k1s12/2.0, *sigma_22 + k1s22/2.0),
		
		k3s12 = dt * f(*t + dt/2.0, *sigma_12 + k2s12/2.0, *sigma_22 + k2s22/2.0),
		k3s22 = dt * g(*t + dt/2.0, *sigma_12 + k2s12/2.0, *sigma_22 + k2s22/2.0), k4s12 = dt * f(*t + dt/2.0, *sigma_12 + k2s12/2.0, *sigma_22 + k2s22/2.0),
		k4s22 = dt * g(*t + dt/2.0, *sigma_12 + k2s12/2.0, *sigma_22 + k2s22/2.0);
	
	*t = *t + dt;
	*sigma_12 = *sigma_12 + (k1s12 + 2 * k2s12 + 2 * k3s12 + k4s12)/6.0;
	*sigma_22 = *sigma_22 + (k1s22 + 2 * k2s22 + 2 * k3s22 + k4s22)/6.0;
}
\end{lstlisting}
As funções $f(~)$ e $g(~)$ são $\dot{\sigma}_{12}$ e $\dot{\sigma}_{22}$, respectivamente. São escritas no algoritmo da seguinte forma: 
\begin{lstlisting}
//sigma_12'()
double complex f(double t, double complex sigma_12, double complex sigma_22)
{
	return (I*delta - gamma_coerencia_12) * sigma_12 - I * omega_0 * (1 - 2 * sigma_22 ) / 2.0;
}

//sigma_12'()
double complex g(double t, double complex sigma_12, double complex sigma_22)
{
	float complex i_o_s = - I * omega_0 * conj(sigma_12) / 2.0;
	return - (gama_populacao_12 * sigma_22) + i_o_s + conj( i_o_s );
}
\end{lstlisting}   
Os resultados são gravados em arquivo, a partir das funções:
\begin{lstlisting}
//Função que cria o arquivo onde vao ser gravado os dados
void criar_arquivo(int a)
{
	FILE *arquivo;
	arquivo=fopen("runge_cutta_bloch.dat","w");
	if(a==1) fprintf(arquivo, "tempo,real_s12,img_s12,s22\n");
	else fprintf(arquivo, "delta,real_s12,img_s12,s22\n");
	fclose(arquivo);
}
//Função que imprimi os resultados em arquivo 
void imprimir_arquivo(double t_ou_delta, double complex sigma_12, double complex sigma_22)
{
	FILE *arquivo;
	arquivo=fopen("runge_cutta_bloch.dat","a+");   
	fprintf(arquivo, "%e,%e,%e,%e\n", t_ou_delta, creal(sigma_12), cimag(sigma_12), creal(sigma_22));
	fclose(arquivo);
}
\end{lstlisting}
Por fim, temos a função principal onde definimos a condições iniciais e trazemos o laço $for(~)$, para obtermos $\sigma_{12}(t+dt)$ e $\sigma_{22}(t+dt)$ em diferente valores de $t$ (ver resultado na figura \ref{fig:p22xt}).   
\begin{lstlisting}
//Função principal 
int main(void)
{
	double complex sigma_12 = 0, sigma_22 = 0;
	double t = 0 , dt = 1e-9, T = 6000;
	criar_arquivo(1);
	imprimir_arquivo(t, sigma_12, sigma_22);
	for (int i = 1; i < T; i++)
	{
		rk4(f, g , dt, &t, &sigma_12, &sigma_22);
		imprimir_arquivo(t, sigma_12, sigma_22);
	}
	
}
\end{lstlisting}

\subsection{Resultados}

A figura \ref{fig:p22xt} mostra os resultados numéricos obtidos para a evolução temporal da população $\sigma_{22}$, conforme o campo contínuo se propaga pelo ensemble de átomos de rubídio 87. A taxa de relaxação $\gamma_{12}$ é calculado a partir da equação \eqref{eq:4.51} (ignorando o termo de defasagem), onde obtemos que $\gamma_{12} = \Gamma_{12}/2$. No primeiro caso apresentado em Fig.\ref{fig:p22xt}(a), os átomos de dois níveis estão em ressonância ($\delta/\gamma_{12}=0$) com o campo CW. O que acarreta interferências construtivas e assim faz a população de $\sigma_{22}$ variar positivamente ao longo do tempo até atingir um platô de aproximadamente $\sigma_{22} \approx 1\vdot 10^{-3}$. Os gráficos apresentado em Fig.\ref{fig:p22xt}(b), Fig.\ref{fig:p22xt}(c) e Fig.\ref{fig:p22xt}(d) representam casos dissonantes com $\delta/\gamma_{12}=2$, $\delta/\gamma_{12}=5$ e $\delta/\gamma_{12}=10$, respectivamente. Nestes casos, observamos que a população $\sigma_{22}$ sofre oscilações que vão sendo amortecidas ao longo do tempo, conforme o campo interage com os átomos. Podemos ver também que quanto maior o valor de $\delta$, maior é a frequência em que $\sigma_{22}$ oscila. Isso ocorre devido à interferência destrutiva e construtivas neste processo. Por fim, podemos ver que todas as curvas tendem a estados aproximadamente estacionários. Aproveitando deste fato, elaboramos os gráficos presente na figura \ref{fig:p22xdelta}.

%\begin{figure}[H]
%	\centering
%	\caption{Evolução temporal da população $\sigma_{22}$ exitada por um campo contínuo, onde (a) $\delta/2\pi=0$ Mhz, (b) $\delta/2\pi=10$ Mhz, (c) $\delta/2\pi=50$ Mhz e (d) $\delta/2\pi=100$ Mhz.}
%	\label{fig:p22xt}
%	\includegraphics[width=0.9\linewidth]{figuras_do_trabalho/p22xt}
%\end{figure}

\begin{sagesilent}
	import pandas as pd
	
	nome_dataframe = pd.read_csv('arquivo_solucoes/runge_cutta_bloch.dat')
	A=line(zip(nome_dataframe.tempo*1e6,nome_dataframe.s22*1e3),figsize=(4,4),frame=true, axes = false) + text("(a)",(0.9,50), color="black")


	nome_dataframe = pd.read_csv('arquivo_solucoes/runge_cutta_bloch2.dat')
	B=line(zip(nome_dataframe.tempo*1e6,nome_dataframe.s22*1e3),figsize=(4,4),frame=true, axes = false) + text("(b)",(0.9,17), color="black")

	
	nome_dataframe = pd.read_csv('arquivo_solucoes/runge_cutta_bloch5.dat')
	C=line(zip(nome_dataframe.tempo*1e6,nome_dataframe.s22*1e3),figsize=(4,4),frame=true, axes = false) + text("(c)",(0.9,5.2), color="black")

	
	nome_dataframe = pd.read_csv('arquivo_solucoes/runge_cutta_bloch10.dat')
	D=line(zip(nome_dataframe.tempo*1e6,nome_dataframe.s22*1e3),figsize=(4,4),frame=true, axes = false) + text("(d)",(0.9,1.7), color="black")

	
	E = graphics_array([[A,B],[C,D]])
\end{sagesilent}
\begin{figure}[H]
	\centering
	\caption{Evolução temporal da população $\sigma_{22}$ exitada por um campo contínuo, onde (a) $\delta/2\pi=0$ Mhz, (b) $\delta/2\pi=10$ Mhz, (c) $\delta/2\pi=50$ Mhz e (d) $\delta/2\pi=100$ Mhz.}
	\label{fig:p22xt}
	\sageplot[scale=0.8]{E,xmin=0,xmax=1, axes_labels=['$t$($\mu s$)','$\sigma_{22}\cdot 10^3$'], figsize=(8,7)}
\end{figure}	


Na figura \ref{fig:p22xdelta} apresentamos os resultados numéricos para população $\sigma_{22}$ e coerência $\sigma_{12}$ em função da dessintonia no estado estacionário. Adotamos os mesmos parâmetros $\Omega_0$, $\Gamma_{12}$ e $\gamma_{12}$ utilizados nos resultados mostrados na figura \ref{fig:p22xt}. Na curva Fig.\ref{fig:p22xt}(a) podemos ver que quanto mais próximo da ressonância, maior é a Amplitude da população $\sigma_{22}$. Em Fig.\ref{fig:p22xt}(b) e Fig.\ref{fig:p22xt}(c) está representada coerência $\sigma_{12}$. Na componente real Fig.\ref{fig:p22xt}(b) podemos ver que na ressonância está a maior taxa de variação. A componente imaginária Fig.\ref{fig:p22xt}(c) possui seu valor mínimo na ressonância. Os três resultados tendem a zero para valores grande de dessintonia.
\begin{sagesilent}
	import pandas as pd
	
	nome_dataframe = pd.read_csv('arquivo_solucoes/runge_cutta_bloch_delta.dat')
	A=line(zip(nome_dataframe.delta,nome_dataframe.s22*1e2),figsize=(4,4),frame=true, axes = false, axes_labels=['$\delta/\gamma_{12}$','$\sigma_{22}\cdot10^2$']) + text("(a)",(22,5), color="black")
	
	
	B=line(zip(nome_dataframe.delta,nome_dataframe.img_s12*1e2),figsize=(4,4),frame=true, axes = false, axes_labels=['$\delta/\gamma_{12}$','$\Re(\sigma_{12})\cdot10^2$']) + text("(b)",(22,-3), color="black")

	
	C=line(zip(nome_dataframe.delta,nome_dataframe.real_s12*1e2),figsize=(4,4),frame=true, axes = false, axes_labels=['$\delta/\gamma_{12}$','$\Im(\sigma_{12})\cdot10^2$']) + text("(c)",(22,9), color="black")
	

	E = graphics_array([[A],[B],[C]])
\end{sagesilent}
\begin{figure}[H]
	\centering
	\caption{População $\sigma_{22}$ em função da dessintonia $\delta$ em um estado estacionário.}
	\label{fig:p22xdelta}
	\sageplot[scale=0.7]{E, figsize=(8,10)}
\end{figure}
%\begin{figure}[H]
%	\centering
%	\caption{População $\sigma_{22}$ em função da dessintonia $\delta$ em um estado estacionário.}
%	\label{fig:p22xdelta}
%	\includegraphics[width=0.90\linewidth]{figuras_do_trabalho/p22xdelta.eps}
%\end{figure}


\chapter{Propagação de pulso de Luz em sistema atômicos}\label{cap:maxwellbloch}


Estudamos até aqui as transições populacionais ocorrendo em um ensemble de sistemas de dois níveis que interage com campos eletromagnéticos contínuos. Neste Capítulo, pretendemos estudar o que ocorre com um pulso eletromagnético após interações com sistemas deste tipo. Mais especificamente, estudaremos o comportamento de um pulso eletromagnético ultracurto a medida que ele se propaga por uma amostra de muitos átomos, sendo cada átomo um sistema de dois níveis. Para isso, resolvemos numericamente as equações de Maxwell-Bloch.


\section{Equações de Maxwell-bloch para um sistema de dois níveis}

No Capítulo \ref{cap:capitulo3}, reduzimos equação de propagação de onda em meios não lineares, obtendo a seguinte equação:

\begin{equation}
	\pdv{z}\tilde{\mathcal{E}}(z,\tau)  = -\frac{i\mu_0}{2k_c}{\omega_c}^2\tilde{\mathcal{P}}^{NL}(z,\tau).
	\label{eq:5.1}
\end{equation}
Sendo que $\mathcal{\tilde{P}}^{NL}$ é a parte lenta da polarização do meio não linear. A forma mais geral de representar a polarização é através do somatório dos momentos de dipolos induzidos em cada átomo pelo campo por unidade de volume, conforme definimos em \eqref{eq:3.7}. Como estamos trabalhando com um sistema de muitos átomos idênticos, podemos reescrevê-la da seguinte forma:
\begin{eqnarray}
\vb{P}^{NL} &=& \frac{1}{V}\sum_i \vb{d}_i * \qty(\frac{N_{\text{átomos}}}{N_{\text{átomos}}})\nonumber\\
&=& \mathcal{N}\qty(\frac{1}{N_{\text{átomos}}}\sum_i \vb{d}_i)\nonumber\\
&=& \mathcal{N}\langle \vb{d}_i\rangle_{\text{átomos}}, \label{eq:5.2}
\end{eqnarray}
onde $\mathcal{N}=N_\text{átomos}/V$ é o número de átomos por unidade de volume e $\langle \vb{d}_i\rangle_\text{átomos}$ é o momento de dipolo médio da amostra de átomos. 

Observamos no Capítulo \ref{cap:capitulo2} que, na representação de matriz densidade, o valor médio de um dado observável obedece à equação \eqref{eq:6}. Aplicando à equação da polarização \eqref{eq:5.2} para um sistema de dois níveis, obtemos:
\begin{eqnarray}
	P^{NL} &=& \mathcal{N}\Tr(\hat{\rho} \hat{d})\\
	&=& \mathcal{N}(d_{12} p_{21} + d_{21} p_{12}).
\end{eqnarray}
Significa que a polarização é proporcional a coerência atômica. Como estamos trabalhando com campo que se propaga no eixo z, é conveniente redefinirmos $\rho_{12} \equiv \sigma_{12}e^{i(kz-\omega t)}$. Assim, considerando o fato que $\rho_{21}=\rho_{12}^*$ e $d_{21} = d_{12}$, e usando \eqref{eq:3.46}, temos que:
\begin{eqnarray}
	\frac{1}{2}\mathcal{P}^{NL}(z, t)e^{i(k_cz-\omega_ct)} + \frac{1}{2}\mathcal{P}^{NL*}(z, t)e^{-i(k_cz-\omega_ct)}= \mathcal{N}(d_{12} \sigma_{12}e^{i(k_cz-\omega_ct)} + d_{12}\sigma_{12}^*e^{-i((k_cz-\omega_ct)}).
\end{eqnarray}
Analisando os dois lados da equação, é razoável concluirmos que 
\begin{eqnarray}
	\mathcal{P}= 2\mathcal{N}d_{12} \sigma_{12}.
	\label{eq:polar1}
\end{eqnarray} 

Para meios não homogêneos em que o efeito doppler é significativo a equação se torna:
\begin{eqnarray}
	\mathcal{P}^{NL}= 2\mathcal{N}d_{12} \int_{-\infty}^{\infty} d\delta G(\delta,t) \sigma_{21}(\delta,t),
	\label{eq:polar2}
\end{eqnarray}
onde
\begin{eqnarray}
	\int_{-\infty}^{\infty} d\delta G(\delta,t) = 1 .
	\label{eq:funcg}
\end{eqnarray} 
Trabalharemos com átomos frios, onde $G(\delta) \approx \delta_d(\delta)$ ($\delta_d$ é a função delta de Dirac). Com isso, a equação \eqref{eq:polar2} recai em \eqref{eq:polar1} e podemos reescrever a equação \eqref{eq:5.1} da seguinte maneira:
\begin{equation}
	\pdv{z}\tilde{\mathcal{E}}(z,\tau)  = -\frac{i\mu_0}{k_c}{\omega_c}^2\mathcal{N}d_{12} \sigma_{12}(z,\tau).
	\label{eq:5.11}
\end{equation}
Como as equações de bloch ópticas foram escritas  em termos da frequência de rabi, é conveniente substituirmos \eqref{eq:4.56} em \eqref{eq:5.11}. Assim, obtemos
\begin{equation}
	\pdv{\eta}\Omega_0(z,\tau)  = - i\alpha\sigma_{21}(z,\tau),
	\label{eq:5.12}
\end{equation}
onde $\alpha\equiv\mu_0{\omega_c}^2\mathcal{N}{d_{12}}^2/k_c\hbar$ é uma constante. As equações óptica de bloch \eqref{eq:4.61} e \eqref{eq:4.62} precisam passar pela mesma mudança de coordenadas que aplicamos à \eqref{eq:5.12}. Assim, precisamos rescrevê-las da seguinte forma:
\begin{eqnarray}
	\pdv{\tau}\sigma_{12}(z, \tau) & = &  [i \delta - \gamma_{12}]\sigma_{12}(z, \tau) -  i\frac{1}{2}\Omega_0(z, \tau)[1 - 2\sigma_{22}(z, \tau)]\label{eq:5.13}\\
	\pdv{\tau}\sigma_{22}(z, \tau) & = &  -i\frac{1}{2}\Omega_0(z, \tau)\sigma_{12}^*(z, \tau) + i\frac{1}{2}\Omega_0^*(z, \tau)\sigma_{12}(z, \tau) - \Gamma_{12}\sigma_{22}(z, \tau).\label{eq:5.14}
\end{eqnarray} 

O conjunto das equações \eqref{eq:5.12}, \eqref{eq:5.13} e \eqref{eq:5.14} são conhecidas na literatura como equações de Maxwell-Bloch. Neste TCC, essa equações são resolvidas numericamente e os resultados estão apresentados na Seção \ref{sec:res_maxwell_bloch} deste Capítulo.

\section{Teorema de Área}
\label{sec:area}
Pra trabalharmos com pulsos eletromagnéticos ultracurtos é importante conhecermos a área da envoltória pulso.  Essa área é obtida a partir da seguinte integral:
\begin{equation}
	\theta(z) \equiv \int_{-\infty}^{\infty} \Omega_0(z, \tau) dt
\end{equation}
onde $\theta(z)$ é a área do pulso e $\Omega_0(z, \tau)$ é a frequência de Rabi. Aplicando essa definição as equações de Maxwell-Bloch para um meio ressonante, cujo tempo de decaimento é muito maior que a largura temporal do pulso 
($1/\Gamma_{12} \gg T_p$),  é possível calcular a variação da área do pulso, conforme o pulso se propaga no meio,  como descrito em Erbely \cite{allen1987optical}. Assim, obtemos que 
\begin{equation}
	\pdv{\theta}{z} = -\frac{\alpha'}{2}sin(\theta)
	\label{eq:theta}
\end{equation}
onde $\alpha'$ é  o coeficiente de absorção e difere da constante $\alpha$, pois $\alpha' = \alpha \pi G(0)$. O termo $G(0)$ é o valor máximo da função de distribuição do efeito doppler, ao qual que ignoramos neste trabalho. A equação \eqref{eq:theta} é conhecida como teorema da área. A solução dessa equação é:
\begin{equation}
	tan\qty(\frac{\theta}{2}) = tan\qty(\frac{\theta_0}{2})e^{-\frac{\alpha'}{2}z}, 
	\label{eq:teo_area}
\end{equation}
onde $\theta_0$ e a área inicial do pulso.

Na figura \ref{fig:teoremaarea} apresentamos os resultado da equação \eqref{eq:teo_area} para diferentes valores $\theta_0$ entre $0$ e $7\pi$. Para isso, utilizamos o valor genérico para o coeficiente de absorção $\alpha'= 2\pi$. Podemos ver que após o pulso ultracurto ser propagado pela amostra, os valores das áreas tendem para $\theta(z) = \{0, 2\pi, 4\pi, 6\pi, dots, n\pi\}$, onde $n$ é par. Para $0<\theta_0<\pi$ a área do pulso diminui até chegar à zero. Para $\pi < \theta_0 < 2\pi$ a área do pulso aumenta para $2\pi$. A mesma tendência é observada para as demais valores de $\theta_0$. Na Seção \ref{sec:res_maxwell_bloch} discutimos mais a fundo esse comportamento a partir dos resultados das equações de Maxwell-bloch.    
%\begin{figure}[H]
%	\centering
%	\caption{Resultado da equação \eqref{eq:teo_area} para um pulso ultracurto, conforme ele se propaga em um meio atômico de dois níveis}
%	\label{fig:teoremaarea}
%	\includegraphics[width=0.5\linewidth]{figuras_do_trabalho/teoremadaarea}
%\end{figure}

\begin{sagesilent}
alpha = 2*3.1415

A=plot([], ticks = [None,pi], tick_formatter =[None,pi])
for theta0 in [0*pi,0.01*pi,..,0.99*pi]:
 theta(z) = 2*arctan(tan(theta0/2)*exp(-(alpha/2)*z))
 A+= plot(theta(z), z, 0,0.0005*5000)

for theta0 in [1.01*pi,1.02*pi,..,1.99*pi]:
 theta(z) = 2*arctan(tan(theta0/2)*exp(-(alpha/2)*z))
 A += plot(theta(z)+2*pi, z, 0,0.0005*5000) 

for theta0 in [0*pi,0.01*pi,..,0.99*pi]:
 theta(z) = 2*arctan(tan(theta0/2)*exp(-(alpha/2)*z))
 A += plot(theta(z) + 2*pi, z, 0,0.0005*5000) 

for theta0 in [1.01*pi,1.02*pi,..,1.99*pi]:
 theta(z) = 2*arctan(tan(theta0/2)*exp(-(alpha/2)*z))
 A += plot(theta(z)+4*pi, z, 0,0.0005*5000) 

for theta0 in [0*pi,0.01*pi,..,0.99*pi]:
 theta(z) = 2*arctan(tan(theta0/2)*exp(-(alpha/2)*z))
 A += plot(theta(z) + 4*pi, z, 0,0.0005*5000)

for theta0 in [1.01*pi,1.02*pi,..,1.99*pi]:
 theta(z) = 2*arctan(tan(theta0/2)*exp(-(alpha/2)*z))
 A += plot(theta(z)+6*pi, z, 0,0.0005*5000) 

for theta0 in [0*pi,0.01*pi,..,0.99*pi]:
 theta(z) = 2*arctan(tan(theta0/2)*exp(-(alpha/2)*z))
 A += plot(theta(z) + 6*pi, z, 0,0.0005*5000)    

A.show(frame=true, axes=false, axes_labels=("$z$","$\\theta$"))
\end{sagesilent}

\begin{figure}[H]
	\centering
	\caption{Resultado da equação \eqref{eq:teo_area} para um pulso ultracurto, conforme ele se propaga em um meio atômico de dois níveis}
	\label{fig:teoremaarea}
	\sageplot[scale=0.7]{A, frame=true, axes=false, axes_labels=["$z$","$\\theta$"]}
\end{figure}

\section{Metodologia}



Para resolver a equação de Maxwel-Bloch numericamente, precisaremos discretizar o meio atômico no eixo $z$. Assim, teremos um conjunto de seções com largura $dz$ (ver figura \ref{fig:secoes_meio}), onde estabelecemos como condição de contorno, que cada seção possui um sistema de átomos de dois níveis caracterizado por $\sigma_{22}$ e $\sigma_{12}$. Desta forma, o pulso interage com a primeira seção sofre modificações devido ao fenômenos de absorção e dispersão. Esse novo pulso interage com a próxima seção e sofre novamente modificações. Esse processo se repete por todo o meio e o pulso sempre encontra uma seção na condição inicial ($\sigma_{22}[z,\tau=0]=0$ e $\sigma_{12}[z,\tau=0]=0$). Isso é possível, pois nos aproximamos do resultado correto quando $dz$ é muito pequeno.

A população $\sigma_{22}$ e coerência $\sigma_{12}$ é calculada, usando método de Runge-Kutta descrito na Seção \ref{sec:metodo1}. Também aplicaremos esse método para calcular a frequencia de Rabi $\Omega_0$. Assim,  a frequência de Rabi  $\Omega_0(z+dz,\tau)$ é obtida da seguinte forma:
\begin{equation}
	\Omega_0(z+dz,\tau) = \Omega_0(z,\tau) + \frac{dz}{6}\qty(k1 + 2k_2 + 2k_3 + k_4),
\end{equation}
onde
\begin{eqnarray}
	k_1 & = & -\frac{i\mu_0}{k_c}{\omega_c}^2\mathcal{N}d_{12} \sigma_{21}[\Omega_0(z,\tau),\tau] \\
	k_2 & = & -\frac{i\mu_0}{k_c}{\omega_c}^2\mathcal{N}d_{12} \sigma_{21}[\Omega_0(z,\tau) + k_1 \frac{dz}{2},\tau] \\
	k_3 & = & \frac{i\mu_0}{k_c}{\omega_c}^2\mathcal{N}d_{12} \sigma_{21}[\Omega(z,\tau) + k_2 \frac{dz}{2},\tau] \\
	k_4 & = & -\frac{i\mu_0}{k_c}{\omega_c}^2\mathcal{N}d_{12} \sigma_{21}[\Omega(z,\tau) + k_3 dz,\tau]
\end{eqnarray}


\begin{sagesilent}
	E(t) = sech(t)*cos(5*t)
	A=plot(E(t), t,-10,10,thickness=4, figsize= (6,3))
\end{sagesilent}

\begin{figure}
	\centering
	\caption{Representação da condição de contorno realizada em $\sigma_{12}$ e $\sigma_{22}$}
	\label{fig:secoes_meio}
	\begin{tikzpicture}
		
		\draw[fill=black!30!white] (0,1.5) -- (0,2.5) -- (1.6,3.8) -- (1.6,0.1) -- (0,1.5) ;
		\draw[fill=black!30!white] (1.6,0.1) -- (1.6,3.8) -- (2.2,3.4) -- (2.2,0.7) -- node[rotate=44, below]{$\underbrace{~~~~~~~~}_{dz}$} (1.6,0.1);
		
		\begin{scope}[rotate=180]
			\foreach \i in {1.65}{
				\foreach \j in {1.05*\i,1.25*\i,1.45*\i,1.65*\i,1.85*\i,2.05*\i,2.25*\i,2.45*\i}{
					\shade[ball color=green!5!red](\i-3.6,\j-2.2-1.6*\i) circle (0.09*\i);
				}
			}
		\end{scope}
		
		\begin{scope}
			\foreach \i in {0.5,0.6,0.75,0.9,1.1,1.35,1.65,2}{
				\foreach \j in {1.05*\i,1.25*\i,1.45*\i,1.65*\i,1.85*\i,2.05*\i,2.25*\i,2.45*\i}{
					\shade[ball color=green!5!red](\i-0.4,\j+2-1.8*\i) circle (0.09*\i);
				}
			}
		\end{scope}
		\draw (1.6,3.8) -- (1.6,0.1);
		\draw[fill=black!30!white] (5,0) -- (5,3) -- (10,3) -- (10,0) -- (5,0);
		\draw[-latex] (5,3.2) -- node[above]{$z$}(6,3.2);
		\foreach \x in {6,7,...,10}{
			\draw (\x,0) -- (\x,3);
			\node at (\x-0.5,-0.4){$\underbrace{~~~~~~~~~}_{dz}$};
			\node at (\x-0.5,1.2){$_{\sigma_{12} = 0}$};
			\node at (\x-0.5,1.7){$_{\sigma_{22} = 0}$};
		}
		
		\node[rotate=0.4] at (-0.8,2) {\sageplot[scale=0.2]{A, frame=false, axes = false,transparent=True}};
		
		\node[rectangle, draw,text width=11.2em,text badly centered] (r) at (7.5,4.3) {Meio atômico dividido em seções};
	\end{tikzpicture}
\end{figure}
%\begin{figure}[H]
%	\caption{\label{metodoestatisto.fluxograma} Fluxograma mostrando os passos do Método Científico.}
%	
%	\usetikzlibrary{shapes,arrows}
%	\usetikzlibrary{positioning}
%	\usetikzlibrary{shadows}
%	\centering
%	
%	% Define block styles
%	\tikzstyle{block} = [rectangle, draw, fill=green, 
%	text width=6em, text centered, rounded corners, node distance=1cm, minimum height=2em]
%	\tikzstyle{line} = [draw, -latex]
%	\tikzstyle{cloud} = [draw, ellipse,fill=white, node distance=1cm,
%	minimum height=2em]
%	\tikzstyle{decision} = [diamond, draw, fill=blue!20, 
%	text width=4.5em, text badly centered, node distance=1cm, inner sep=0pt]
%	
%	\begin{tikzpicture}[node distance = 3cm, auto]
%		
%		% Place nodes
%		\node[cloud](inicio){início};
%		\node[decision, below=of inicio](does){$z<Z$};
%		\node[decision, below=of does](does2){$t<T$};
%		\node [block, right= of does2 ](omega) {Calcula Runge-Kutta para $\Omega_0(z,t)$};
%		\node [block, right = of omega] (s22) {Calcula Runge-Kutta para $\sigma_{22}(z,t)$ e $\sigma_{12}(z,t)$};
%		\node[cloud,right=of does](fim){fim};
%		
%		% Draw edges
%		\path [line] (inicio) -- (does);
%		\path [line] (does) -- node{sim}(does2);
%		\path [line] (does2) -- node{sim} (omega);
%		\path [line] (omega) -- (s22);
%		\path [line] (s22) |- (5,-7.8) -| (does2);
%		\path [line] (does2) -| node{não}(-2,-5.7) |- (does);
%		\path [line](does) -- node{não}(fim);
%	
%	\end{tikzpicture}
%\end{figure}
O algoritmo é escrito em linguagem C e inicia com as seguintes bibliotecas e variáveis globais~($delta=\delta$, $gamma \_ populacao \_ 12 = \Gamma_{12}$, $alpha = \alpha$, $gamma \_ coerencia \_ 12 = \gamma_{12}$, $Tp=T_p$, $N = \theta_0/\pi$, $dz=$ largura~de~cada~passo~de~$z$, $dt=$ largura~de~cada~passo~de~$\tau$, $T=$ número de passo em $\tau$ e $Z=$ número de passo em $z$):
\begin{lstlisting}
//Bibliotecas
#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <complex.h>
#include <stdbool.h> 

//PARÂMETROS DA INTERAÇÃO
double delta, gama_populacao_12,alpha,gamma_coerencia_12,Tp,N, omega_0,dz,dt,t; 
int Z,T;
\end{lstlisting}  

Para calcular $\sigma_{12}(t+dt)$ e $\sigma_{22}(t+dt)$, incluímos  as funções $rk4s(\dots)$, $f(\dots)$ e $g(\dots)$ que apresentamos na Seção~\ref{sec:metodo1}. Para o cálculo de $\omega_0(z+dz)$, implementamos o método de Runge-Kutta na função $rk4o(\dots)$:   
\begin{lstlisting}
//Método de Runge-kutta omega
void rk4o(double complex(*f)(double complex, double complex, double complex), double complex(*g)(double complex, double complex, double complex), double complex(*h)(double complex),  double complex *omega, double complex omega_ant, double complex *omega_k, double complex *sigma_12, double complex *sigma_22, double complex *sigma_12_k, double complex *sigma_22_k, bool cond_t)
{   
	double complex k1,k2,k3,k4;
	
	if(cond_t)
	{   
		k1=0;k2=0;k3=0;k4=0;
	}
	else
	{
		rk4s(f, g , dt, sigma_12, sigma_22, *omega, omega_ant);
		k1 = h(*sigma_12);
		
		rk4s(f, g , dt, &sigma_12_k[0], &sigma_22_k[0], *omega + k1*dz/2.0, omega_k[0]);
		omega_k[0] = *omega + k1/2.0;
		k2 = h(sigma_12_k[0]);
		
		rk4s(f, g , dt, &sigma_12_k[1], &sigma_22_k[1], *omega + k2*dz/2.0, omega_k[1]);
		omega_k[1] = *omega + k2*dz/2.0;
		k3 = h(sigma_12_k[1]);
		
		rk4s(f, g , dt, &sigma_12_k[2], &sigma_22_k[2], *omega + k3*dz, omega_k[2]);
		omega_k[2] = *omega + k3*dz;
		k4 = h(sigma_12_k[2]);
	}
	*omega = *omega + dz*(k1+2.0*k2+2.0*k3+k4)/6.0;       
}
\end{lstlisting}

A função $h(\dots)$ acima é $\Omega_0'$, implementada no algoritmo da seguinte forma:
\begin{lstlisting}
//omega'()
double complex h( double complex sigma_12) 
{
	return -I*alpha*sigma_12;
}
\end{lstlisting}

Os resultados são gravados em arquivos, através das funções:
\begin{lstlisting}
//Função que cria arquivo
void cria_arquivo_matriz()
{
	FILE *arquivo;
	arquivo=fopen("runge_cutta_omega.dat","w");
	FILE *arquivo2;
	arquivo2=fopen("runge_cutta_sigmaR.dat","w");
	FILE *arquivo3;
	arquivo3=fopen("runge_cutta_sigmaI.dat","w");
	FILE *arquivo4;
	arquivo4=fopen("runge_cutta_rho.dat","w");
	
	fclose(arquivo);
	fclose(arquivo2);
	fclose(arquivo3);
	fclose(arquivo4);
}
//Função que salva os resultados em arquivo 
void imprimir_matriz(double complex **omega, double complex **sigma_22, double complex **sigma_12)
{
	FILE *arquivo;
	arquivo=fopen("runge_cutta_omega.dat","a+");
	FILE *arquivo2;
	arquivo2=fopen("runge_cutta_sigmaR.dat","a+");
	FILE *arquivo3;
	arquivo3=fopen("runge_cutta_sigmaI.dat","a+");
	FILE *arquivo4;
	arquivo4=fopen("runge_cutta_rho.dat","a+");
	
	for (int p = 0; p < Z+1; p++)
	{   
		if(p==0)
		{
			fprintf(arquivo , "t\\z ");
			fprintf(arquivo2, "t\\z ");
			fprintf(arquivo3, "t\\z ");	
			fprintf(arquivo4, "t\\z ");
		}
		else 
		{
			fprintf(arquivo, "%e ", (p-1)*dz);
			fprintf(arquivo2, "%e ", (p-1)*dz);
			fprintf(arquivo3, "%e ", (p-1)*dz);
			fprintf(arquivo4, "%e ", (p-1)*dz);
		}
	}
	fprintf(arquivo, "\n");
	fprintf(arquivo2, "\n");
	fprintf(arquivo3, "\n");
	fprintf(arquivo4, "\n");
	
	for (int k=0; k<T; k++){ 
		fprintf(arquivo, "%e ", (k-120)*dt/(2*M_PI*5.746e6));
		fprintf(arquivo2, "%e ", (k-120)*dt/(2*M_PI*5.746e6));
		fprintf(arquivo3, "%e ", (k-120)*dt/(2*M_PI*5.746e6));
		fprintf(arquivo4, "%e ", (k-120)*dt/(2*M_PI*5.746e6));
		
		for (int p=0; p<Z; p++){
			fprintf(arquivo, "%e ",(creal(omega[p][k]*(2*M_PI*5.746e6))));
			fprintf(arquivo2, "%e ",creal(sigma_12[p][k]));
			fprintf(arquivo3, "%e ", cimag(sigma_12[p][k]));
			fprintf(arquivo4, "%e ",creal(sigma_22[p][k]));
		}
		fprintf(arquivo, "\n");
		fprintf(arquivo2, "\n");
		fprintf(arquivo3, "\n");
		fprintf(arquivo4, "\n");
	}
	fclose(arquivo);
	fclose(arquivo2);
	fclose(arquivo3);
	fclose(arquivo4);
}
\end{lstlisting}  

Por fim, temos a função $main(\dots)$ onde estabelecemos as condições iniciais e condições de contorno, definimos os parâmetros da interação e implementamos o laço de repetição para obtermos $\sigma_{12}(z,\tau)$, $\sigma_{22}(z,\tau)$ e $\Omega_0(z,\tau)$ para diferentes valores de $z$ e $\tau$.  
\begin{lstlisting}
int main(void)
{
	//parametros
	delta=0;
	gama_populacao_12=1; // 5,746*2pi MHz
	alpha= 1e5; //5,746*2pi MHz/cm
	gamma_coerencia_12=1/2.0; //5,746*2pi MHz
	Tp=1.510231827e-5; // 1/5,746*2pi MHz
	N = 2.0;// area/pi 
	Z=15000; 
	T=1200;
	dz=0.001;//cm
	dt=0.1e-5; // 1/5,746*2pi MHz
	
	double complex **sigma_12 , **sigma_22, **omega, temp_s12, temp_s22, s12_k[3],s22_k[3],omega_k[3], temp_omega, temp_omega_ant;
	bool cond;
	
	sigma_12 = malloc((Z-1)*sizeof(complex double*));
	sigma_22 = malloc((Z-1)*sizeof(complex double*));
	omega = malloc((Z)*sizeof(complex double*));
	
	for(int p=0; p<Z; p++)
	{
		sigma_12[p] = malloc((T)*sizeof(complex double));
		sigma_22[p] = malloc((T)*sizeof(complex double));
		omega[p] = malloc((T)*sizeof(complex double));
	}
	
	cria_arquivo_matriz();
	
	for (int i = 0; i < Z; i++)
	{
		for (int j = 0; j < T; j++)
		{
			if (i==0)
			{ 
				t= (j-120)*dt;
				omega[i][j] = omega_0*(1/cosh(1.76*t/Tp));
			}
			else
			{   
				if (j==0)
				{
					sigma_12[i-1][j] = 0;
					sigma_22[i-1][j] = 0;
					cond = true;
					for(int k=0; k<3; k++)
					{
						s12_k[k] = 0; s22_k[k] = 0; omega_k[k] = omega[i-1][j];
					}
				}
				else
				{
					cond = false;
				}
				
				temp_omega = omega[i-1][j]; temp_omega_ant= omega[i-1][j-1]; temp_s12 = sigma_12[i-1][j-1]; temp_s22 = sigma_22[i-1][j-1]; 
				rk4o(f,g,h, &temp_omega, temp_omega_ant, omega_k,  &temp_s12, &temp_s22, s12_k,  s22_k, cond);
				
				omega[i][j] = temp_omega; sigma_12[i-1][j] = temp_s12; sigma_22[i-1][j]= temp_s22;
				
			}
		}
	}
	
	imprimir_matriz(omega, sigma_22, sigma_12);
	
	free(sigma_12);
	free(sigma_22);
	free(omega);
}
\end{lstlisting} 
\section{Resultados}
\label{sec:res_maxwell_bloch}
Nos resultados obtidos foram utilizados os parâmetros da transição $5^2S_{1/2} \longrightarrow 5^2P_{1/2}$ do Rubídio-87, apresentados na tabela \ref{tab:rubidio97}. Para a interação aplicamos um pulso ultracurto que parte da posição inicial do meio com formato dado pela secante hiperbólica:
\begin{equation}
	\Omega(0,\tau) = \frac{1,76}{T_p}\frac{\theta_0}{\pi}sech\qty(\frac{1,76\tau}{T_p})
	\label{sech}
\end{equation} 
onde $T_p$ é a largura temporal do pulso e $\theta_0$ é a área. Utilizamos um pulso de $T_p=100$ fs e consideramos que todos os átomos de Rubídio-87 estão em ressonância com o campo ($\delta=0$). Para isso, ignoramos o efeito doppler. Como o tempo de vida da transição $5^2S_{1/2} \longrightarrow 5^2P_{1/2}$ é de $T_{12}=27,70$ ns, conseguimos garantir que o teorema da área seja respeitado, visto que $T_{12}=1/\Gamma_{12}\gg T_p$. Por fim, para obtermos todos os efeitos de interesse desse TCC, adotamos $\alpha = 1\cdot10^5 \Gamma/$cm.

\subsection{Propagação de pulso com área pequena em meio ressonante}

Na literatura temos solução analítica para equações de Maxwell-Bloch quando tratamos um pulso com área muito pequena ($\theta \ll 1$). Para isso, e adotado o limite de Beer's Law, como vemos em trabalho de Crisp~\cite{crisp1970propagation}. Assim, o nosso primeiro resultado numérico foi obtido para um pulso desse tipo com área $\theta_0 = 5,7*10^{-4}\pi$.

O gráfico ilustrado na figura \ref{fig:0pimaxwellbloch} apresenta o resultado numérico para a frequência de rabi $\Omega_0(z,\tau)$, conforme o pulso interage no meio. Na Fig.\ref{fig:0pimaxwellbloch}(a) mostramos o mapa de calor, onde o valor de $\Omega_0(z, \tau)$ é representado em cores. Na Fig.\ref{fig:0pimaxwellbloch}(b) apresentamos o pulso antes de interagir com o meio. Jà, na Fig.\ref{fig:0pimaxwellbloch}(c) temos o pulso na saída do meio atômico ($z=1$ cm). Vemos que a após interagir com o meio atômico a envoltória do pulso adquire um caráter oscilatório que varia entre valores negativos e positivos. Com isso, a área do pulso resultante é de aproximadamente $\theta \approx 0$, como esperado pelo teorema da área apresentado (ver figura \ref{fig:teoremaarea}).
\begin{figure}[H]
	\centering
	\caption{Frequência de Rabi $\Omega_0(z,\tau)$ para pulso de área pequena $\theta = 5,7*10^{-4}\pi$ que interage sistema de dois níveis. (a) gráfico de temperatura para a frequência de Rabi $\omega_0(z,\tau)$. (b) Curva de $\Omega_0(z,\tau)$ para $z=0$. (c) Curva de $\Omega_0(z,\tau)$ para $z=1$cm.}
	\label{fig:0pimaxwellbloch}
	\begin{tikzpicture}
		\node (figura)at(0,0){\includegraphics[width=0.7\linewidth]{figuras_do_trabalho/pequenomaxwellbloch}};
		\node[left of= figura,rotate=90, yshift=0.31\linewidth,xshift=-0.03\linewidth](legendxc){$z$ (cm)};
		\node[right of= legendxc,rotate=-90, yshift=0.685\linewidth](legendx){$\Omega_0$ (GHz)};
		\node[right of= legendxc, yshift=0.28\linewidth,  xshift=0.310\linewidth](legendx){$\Omega_0$ (GHz)};
		\node[below of= figura,yshift=-0.19\linewidth](legendyc){$\tau$ (ps)};
		\node[below of= figura,yshift=0.196\linewidth,xshift=-0.03\linewidth](a){(a)};
		\node[below of= figura,yshift=0.196\linewidth,xshift=0.31\linewidth](b){(b)};
		\node[below of= figura,yshift=0.00\linewidth,xshift=0.31\linewidth](a){(c)};
	\end{tikzpicture}
\end{figure}

A figura \ref{fig:0pimaxwellbloch_s22} mostra os resultado numéricos para a população $\sigma_{22}$ para todo o meio atômico.  Na Fig.\ref{fig:0pimaxwellbloch}(a) apresentamos o mapa de calor, em que $\sigma_{22}(z, \tau)$ é representado em cores. Na Fig.\ref{fig:0pimaxwellbloch_s22}(b) e Fig.\ref{fig:0pimaxwellbloch_s22}(c) temos a excitação da população $\sigma_{22}$ do inicio e fim do meio atômico, respectivamente. Podemos  ver que o campo não consegue produzir excitação significante do nível $5^2S_{1/2}$ para $5^2P_{1/2}$ átomos presentes em $z=0$ ( Fig.\ref{fig:0pimaxwellbloch_s22}(b) ) e o decaimento espontâneo é desprezível no tempo representado após a interação. Nos átomos presentes em $z=1$~cm ( Fig.\ref{fig:0pimaxwellbloch_s22}(c) )  a excitação é ainda mais desprezível que a encontrada no início e tem um caráter oscilatório.
\begin{figure}[H]
	\centering
	\caption{População $\sigma_{22}(z,\tau)$ para um sistema de dois níveis ( transição $5^2S_{1/2} \longrightarrow 5^2P_{1/2}$ do Rubídio-87 ) que interage com um pulso de área pequena $\theta = 5,7*10^{-4}\pi$. (a) Gráfico de temperatura para população $\sigma_{22}(z,t)$. (b) Curva de $\sigma_{22}(z,\tau)$ para $z=0$. (c) Curva de $\sigma_{22}(z,\tau)$ para $z=1$ cm.}
	\label{fig:0pimaxwellbloch_s22}
	\begin{tikzpicture}
		\node (figura)at(0,0){\includegraphics[width=0.7\linewidth]{figuras_do_trabalho/s22pequenomaxwellbloch}};
		\node[left of= figura,rotate=90, yshift=0.31\linewidth,xshift=-0.03\linewidth](legendxc){$z$ (cm)};
		\node[right of= legendxc,rotate=-90, yshift=0.68\linewidth](legendx){$\sigma_{22}$x$10^{-7}$};
		\node[right of= legendxc, yshift=0.26\linewidth,  xshift=0.310\linewidth](legendx){$\sigma_{22}$x$10^{-7}$};
		\node[below of= figura,yshift=-0.17\linewidth](legendyc){$\tau$ (ps)};
		\node[below of= figura,yshift=0.182\linewidth,xshift=-0.03\linewidth, white](a){(a)};
		\node[below of= figura,yshift=0.182\linewidth,xshift=0.32\linewidth](b){(b)};
		\node[below of= figura,yshift=0.00\linewidth,xshift=0.32\linewidth](a){(c)};
	\end{tikzpicture}
\end{figure}
Na figura \ref{fig:0pimaxwellbloch_s12} temos os resultados numéricos para a coerência $\imaginary{(\sigma_{12}(z,\tau))}$. A Fig.\ref{fig:0pimaxwellbloch}(a) mostra o mapa de calor, no qual $\sigma_{12}(z, \tau)$ é representado em cores. A coerência dos primeiro átomos ($z=0$) é representa na Fig.\ref{fig:0pimaxwellbloch_s12}(b)  e na Fig.\ref{fig:0pimaxwellbloch_s12}(c) temos a coerência do últimos átomos ($z=1$ cm). A coerência atômica obedece a taxa de relaxação $\gamma_{12} = \Gamma_{12}/2$ (ignorando termo desfasador). Por isso, $\imaginary{(\sigma_{12})}$ é praticamente estacionário para o tempo representado na Fig.\ref{fig:0pimaxwellbloch_s12}(a).
\begin{figure}[H]
	\centering
	\caption{Coerência atômica $\sigma_{12}(z,t)$ para um sistema de dois níveis ( transição $5^2S_{1/2} \longrightarrow 5^2P_{1/2}$ do Rubídio-87 ) que interage com um pulso de área pequena ($\theta = 5,7*10^{-4}\pi$). (a) Gráfico de temperatura para $\sigma_{12}(z,t)$. (b) Curva de $\sigma_{12}$ para $z=0$. (c) Curva de $\sigma_{12}$ para $z=1$~cm.}
	\label{fig:0pimaxwellbloch_s12}
	\begin{tikzpicture}
		\node (figura)at(0,0){\includegraphics[width=0.7\linewidth]{figuras_do_trabalho/s12pequenomaxwellbloch}};
		\node[left of= figura,rotate=90, yshift=0.31\linewidth,xshift=-0.03\linewidth](legendxc){$z$ (cm)};
		\node[right of= legendxc,rotate=-90, yshift=0.68\linewidth](legendx){$\imaginary\{\sigma_{12}\}$x$10^{-4}$};
		\node[right of= legendxc,yshift=0.26\linewidth,  xshift=0.310\linewidth](legendx){$\imaginary\{\sigma_{12}\}$x$10^{-4}$};
		\node[below of= figura,yshift=-0.17\linewidth](legendyc){$\tau$ (ps)};
		\node[below of= figura,yshift=0.182\linewidth,xshift=-0.03\linewidth](a){(a)};
		\node[below of= figura,yshift=0.182\linewidth,xshift=0.31\linewidth](b){(b)};
		\node[below of= figura,yshift=0.00\linewidth,xshift=0.31\linewidth](a){(c)};
	\end{tikzpicture}
\end{figure}
\begin{figure}[H]
	\centering
	\caption{Frequência de Rabi $\Omega_0(z,t)$ para pulso de área pequena $\theta = 5,7*10^{-4}\pi$ que interage sistema de dois níveis. (a) Gráfico de temperatura para a frequência de Rabi $\omega_0(z,t)$. (b) Curva de $\Omega_0(z,t)$ para $z=0$. (c) Curva de $\Omega_0(z,t)$ para $z=1$cm.}
	\label{fig:0pimaxwellbloch_freq}
	\usetikzlibrary{arrows}
	\begin{tikzpicture}[centered]
		\node at (0,0) (figura){\includegraphics[width=0.5\linewidth]{figuras_do_trabalho/absorcao}};
				\node[left of=figura,rotate=90, yshift=0.23\linewidth] (legendax) {$\Omega_0(z,\omega)$ [Unid. Arbtrária]};
				\node[below of=figura,yshift=-0.25\linewidth,xshift=0.02\linewidth] (legenday) {$(\omega-\omega_0)/2\pi$ [THz]};
				\node[below of= figura,yshift=0.30\linewidth,xshift=0.22\linewidth](a){(a)};
				\node[below of= figura,yshift=0.12\linewidth,xshift=0.22\linewidth](b){(b)};
				\node[below of= figura,yshift=-0.04\linewidth,xshift=0.22\linewidth](a){(c)};
	\end{tikzpicture}
	
\end{figure}
Na figura \ref{fig:0pimaxwellbloch_freq} apresentamos o resultados para $\Omega_0$ no domínio da frequência. Esses resultados foram obtidos a partir de  FFT (Transformada de Fourier rápida) no resultados numéricos obtidos no domínio do tempo. Em Fig.\ref{fig:0pimaxwellbloch_freq}(a) temos o resultado para $z=0$, em Fig.\ref{fig:0pimaxwellbloch_freq}(b) $z = 0,05$ cm e Fig.\ref{fig:0pimaxwellbloch_freq}(c) $z=1,0$ cm. Observamos que ao se propagar pelo meio apenas as frequências próximas ao centro são absorvidas, pois estão em ressonância com a transição $5^2S_{1/2}\longrightarrow5^2P_{1/2}$.

 
 
\subsection{Transparência auto induzida} 

O teorema da área apresentado na Seção \ref{sec:area}, indica que para pulso com área menor que $\pi$ a área vai a zero, conforme o pulso se propaga no meio. Porém, quando o pulso possui área maior que $\pi$ e menor que $2\pi$, temos que área desse pulso deve aumentar até chegar em $2\pi$. Para verificar esse comportamento, aplicamos um pulso de área de $\theta=0,7\pi$ e $\theta=1,7\pi$ ao nosso algoritmo.


Na figura \ref{fig:0.7e1.7pimaxwellbloch} temos representado a propagação de dois pulsos diferentes. Na esquerda temos o pulso com área $\theta = 0,7 \pi$. Neste caso, podemos ver que, ao propaga no meio, sua área se aproxima a $\theta=0$ e o pulso adquire comportamento oscilatório assim como observado no pulso de pequena área (figura \ref{fig:0pimaxwellbloch}). os gráficos a direita mostram um pulso de área $\theta= 1,7\pi$. Neste caso, observamos um aumento da área do pulso que se aproxima de $\theta=2\pi$, o que está de acordo com o teorema da área.

\begin{figure}[H]
	\centering
	\caption{ Na esquerda temos a solução para pulso com $\theta_0 = 0,7$. Na direita temos a solução para pulso com $\theta_0 = 1,7$.}
	\label{fig:0.7e1.7pimaxwellbloch}
	\usetikzlibrary{arrows}
	\begin{tikzpicture}
		\node(figura){\includegraphics[width=0.7\linewidth]{figuras_do_trabalho/0.7-1.7_maxwellbloch.eps}};
		\node[left of= figura,rotate=90, yshift=0.31\linewidth,xshift=0.125\linewidth](legendxc){$z$ (cm)};
		\node[right of= legendxc,rotate=-90, yshift=0.68\linewidth](legendx){$z$ (cm)};
		
		\node[left of= figura,rotate=90, yshift=0.31\linewidth,xshift=-0.165\linewidth](legendxc2){$\Omega_0$ (THz)};
		\node[right of= legendxc2,rotate=-90, yshift=0.68\linewidth](legendx2){$\Omega_0$ (THz)};
		
		\node[right of= legendxc,yshift=0.21\linewidth,  xshift=0.485\linewidth](legendx3){$\Omega_0$ (THz)};
		\node[below of= figura,yshift=-0.28\linewidth,xshift=-0.175\linewidth](legendyc1){$\tau$ (ps)};
		\node[right of= legendxc,yshift=0.21\linewidth, xshift=0.135\linewidth](legendx4){$\Omega_0$ (THz)};
		\node[below of= figura,yshift=-0.28\linewidth,xshift=0.175\linewidth](legendyc2){$\tau$ (ps)};
		\node[draw, above of = legendx4]{$\theta = 0,7\pi$};
		\node[draw, above of = legendx3]{$\theta = 1,7\pi$};
	\end{tikzpicture}
\end{figure}   

Para pulsos com áreas ($2\pi$,$4\pi$, $6\pi$), de acordo com o teorema da área, é esperado que a área não mude conforme o pulso se propaga no meio. Esse fenômeno recebe o nome de transparência auto induzida. Em Eberly \cite{allen1987optical} é apresentado a solução para um pulso com $\theta=2\pi$, onde é considerado o fato que $\dv*{\theta}{z}=0$ para obter a seguinte equação para $\Omega_0(z,t)$:
\begin{equation}
	\Omega_0(z,t) = \frac{2*1,76}{T_p}sech\qty[\frac{1,76}{T_p}\qty(t-\frac{z}{v_g})], 
	\label{eq:2pianalitico}
\end{equation}
onde a velocidade de grupo é dada por 
\begin{equation}
	v_g = \frac{c}{1+\alpha c T_p/1,76}.
\end{equation}

Na figura \ref{fig:2pimaxwellbloch} temos a solução numérica para frequência de Rabi $\Omega_0$ para a propagação de um pulso de área $\theta=2\pi$. Na Fig.\ref{fig:2pimaxwellbloch}(a) temos o gráfico de temperatura onde podemos ver o comportamento do pulso ao se propagar por todo o meio. Em Fig.\ref{fig:2pimaxwellbloch}(b) temos $\Omega_0$ em $z=0$  e na Fig.\ref{fig:2pimaxwellbloch}(c) temos o pulso na saída do meio. Podemos ver que o pulso não sofre mudança significativa ao se propagar pelo meio atômico e mantem $\theta \approx 2\pi$. Resultado coerente com o teorema da área e o resultado analítico \eqref{eq:2pianalitico}.  
\begin{figure}[H]
	\centering
	\caption{Frequência de Rabi $\Omega_0(z,t)$ para pulso de área $\theta = 2\pi$ que interage sistema de dois níveis. (a) gráfico de temperatura para a frequência de Rabi $\omega_0(z,t)$. (b) Curva de $\Omega_0(z,t)$ para $z=0$. (c) Curva de $\Omega_0(z,t)$ para $z=1$ cm.}
	\label{fig:2pimaxwellbloch}
	\begin{tikzpicture}
		\node (figura)at(0,0){\includegraphics[width=0.7\linewidth]{figuras_do_trabalho/2pimaxwellbloch}};
		\node[left of= figura,rotate=90, yshift=0.31\linewidth,xshift=-0.03\linewidth](legendxc){$z$ (cm)};
		\node[right of= legendxc,rotate=-90, yshift=0.685\linewidth](legendx){$\Omega_0$ (GHz)};
		\node[right of= legendxc, yshift=0.28\linewidth,  xshift=0.310\linewidth](legendx){$\Omega_0$ (GHz)};
		\node[below of= figura,yshift=-0.19\linewidth](legendyc){$\tau$ (ps)};
		\node[below of= figura,yshift=0.196\linewidth,xshift=-0.03\linewidth,white](a){(a)};
		\node[below of= figura,yshift=0.196\linewidth,xshift=0.31\linewidth](b){(b)};
		\node[below of= figura,yshift=0.00\linewidth,xshift=0.31\linewidth](a){(c)};
	\end{tikzpicture}
\end{figure}

Em  G. L. Lamb, Jr~\cite{gl1971analytical,allen1987optical} encontramos resultados analíticos para $\theta_0 = $\{$4\pi$ e $6\pi$\}. Um pulso de área $\theta_0 = 4\pi$ pode ser descrito pela colisão de dois pulsos com velocidades de grupos $v_g$ e largura temporal $T_p$ diferentes. Assim, temos a seguinte expressão analítica para $\Omega_0(z,t)$:
\begin{equation}
	\Omega_0(z,t) = \qty(\frac{T_{r}^2 - T_{r'}^2}{T_{r}^2 + T_{r'}^2})\frac{\frac{2}{T_{r}}sech\qty(\frac{\tau}{T_{r}})+\frac{2}{T_{r'}}sech\qty(\frac{\tau'}{T_{r'}})}{1 - \frac{2T_{r}T_{r'}}{T_{r}^2 + T_{r'}^2}\qty[tanh\qty(\frac{\tau}{T_{r}})tanh\qty(\frac{\tau'}{T_{r'}})-sech\qty(\frac{\tau}{T_{r}})sech\qty(\frac{\tau'}{T_{r'}})]},
	\label{eq:4pianalitico}
\end{equation}
onde $T_{r} = T_p/1,76$ e $T_{r'} = T_{p'}/1,76$. Os tempos $\tau$ e $\tau'$ são os tempos medidos nos referenciais de cada pulso e são dados por :
\begin{eqnarray}
	\tau = t - \frac{z}{v_g}\\
	\tau' = t - \frac{z}{v_g'}.
\end{eqnarray}
Essas velocidades de grupo, assim como o caso de $\theta=2\pi$, obedece a relação
\begin{eqnarray}
	v_g = \frac{c}{1+\alpha c T_r}\\
	v_g' = \frac{c}{1+\alpha c T_r'}
\end{eqnarray}


Na figura \ref{fig:4pimaxwellbloch} temos a solução numérica para frequência de Rabi $\Omega_0$ para a propagação de um pulso de área $\theta=4\pi$. Na Fig.\ref{fig:4pimaxwellbloch}(A) temos o gráfico de temperatura onde podemos ver o comportamento do pulso ao se propagar pelo meio. Na Fig.\ref{fig:4pimaxwellbloch}(b) temos $\Omega_0$ em $z=0$  e na Fig.\ref{fig:4pimaxwellbloch}(c) temos o pulso em $z=10$ cm. Podemos ver que o pulso de área $\theta = 4\pi$ se divide em dois pulsos de área $\theta\approx2\pi$, com largura temporal diferentes, assim como a descrição analítica \eqref{eq:4pianalitico}. O segundo pulso se afasta do primeiro conforme se propaga pelo meio. Isso significa que possuem velocidades de grupo $v_g$ diferentes, sendo que o primeiro mantem a velocidade grupo do pulso inicial (sem propagação). 

\begin{figure}[H]
	\centering
	\caption{Frequência de Rabi $\Omega_0(z,t)$ para pulso de área $\theta = 4\pi$ que interage sistema de dois níveis. (a) gráfico de temperatura para a frequência de Rabi $\omega_0(z,t)$. (b) Curva de $\Omega_0(z,t)$ para $z=0$. (c) Curva de $\Omega_0(z,t)$ para $z=10$cm.}
	\label{fig:4pimaxwellbloch}
	\begin{tikzpicture}
		\node (figura)at(0,0){\includegraphics[width=0.7\linewidth]{figuras_do_trabalho/4pimaxwellbloch}};
		\node[left of= figura,rotate=90, yshift=0.31\linewidth,xshift=-0.03\linewidth](legendxc){$z$ (cm)};
		\node[right of= legendxc,rotate=-90, yshift=0.685\linewidth](legendx){$\Omega_0$ (GHz)};
		\node[right of= legendxc, yshift=0.28\linewidth,  xshift=0.310\linewidth](legendx){$\Omega_0$ (GHz)};
		\node[below of= figura,yshift=-0.19\linewidth](legendyc){$\tau$ (ps)};
		\node[below of= figura,yshift=0.196\linewidth,xshift=-0.03\linewidth,white](a){(a)};
		\node[below of= figura,yshift=0.196\linewidth,xshift=0.31\linewidth](b){(b)};
		\node[below of= figura,yshift=0.00\linewidth,xshift=0.31\linewidth](a){(c)};
	\end{tikzpicture}
\end{figure}

Para um pulso com área $\theta=6\pi$, é esperado que o pulso se decomponha em três pulsos de área $\theta=2\pi$, conforme resultado analítico presente em~\cite{gl1971analytical}.
  
A figura \ref{fig:6pimaxwellbloch} traz a solução numérica para frequência de Rabi $\Omega_0(z, \tau)$ para a propagação de um pulso de área $\theta=4\pi$. Na Fig.\ref{fig:6pimaxwellbloch}(a) mostramos o gráfico de temperatura onde podemos ver o comportamento do pulso ao se propagar pelo meio. A Fig.\ref{fig:6pimaxwellbloch}(b) apresenta $\Omega_0$ em $z=0$  e a Fig.\ref{fig:6pimaxwellbloch}(c) temos o pulso em $z=15$~cm. Observamos a tendência do pulso de área $\theta = 6\pi$ ser divido em três pulsos de área $\theta\approx2\pi$, com largura temporal diferentes, assim como a descrição analítica apresentado em \cite{gl1971analytical}. vemos que os três pulsos tem velocidades $v_g$ diferentes, pois se afastam conforme se propagam pelo meio.

\begin{figure}[H]
	\centering
	\caption{Frequência de Rabi $\Omega_0(z,t)$ para pulso de área $\theta = 6\pi$ que interage sistema de dois níveis. (a) gráfico de temperatura para a frequência de Rabi $\omega_0(z,t)$. (b) Curva de $\Omega_0(z,t)$ para $z=0$. (c) Curva de $\Omega_0(z,t)$ para $z=10$ cm.}
	\label{fig:6pimaxwellbloch}
	\begin{tikzpicture}
		\node (figura)at(0,0){\includegraphics[width=0.7\linewidth]{figuras_do_trabalho/6pimaxwellbloch}};
		\node[left of= figura,rotate=90, yshift=0.31\linewidth,xshift=-0.03\linewidth](legendxc){$z$ (cm)};
		\node[right of= legendxc,rotate=-90, yshift=0.685\linewidth](legendx){$\Omega_0$ (GHz)};
		\node[right of= legendxc, yshift=0.28\linewidth,  xshift=0.310\linewidth](legendx){$\Omega_0$ (GHz)};
		\node[below of= figura,yshift=-0.19\linewidth](legendyc){$\tau$ (ps)};
		\node[below of= figura,yshift=0.196\linewidth,xshift=-0.03\linewidth,white](a){(a)};
		\node[below of= figura,yshift=0.196\linewidth,xshift=0.31\linewidth](b){(b)};
		\node[below of= figura,yshift=0.00\linewidth,xshift=0.31\linewidth](a){(c)};
	\end{tikzpicture}
\end{figure}